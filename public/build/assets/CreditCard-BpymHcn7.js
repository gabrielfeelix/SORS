import{d as Z,u as ee,c as r,h as y,a as A,b as N,w as E,e,f as u,l as R,t as l,g as i,i as g,o,j as O,n as _,F as P,r as z,k as I,m as U}from"./app-nPHX7zkZ.js";import{_ as q}from"./MobileToast.vue_vue_type_script_setup_true_lang-BZagNPxY.js";import{_ as J}from"./CreditCardModal.vue_vue_type_script_setup_true_lang-B2KxZ0NR.js";import{_ as G}from"./ConfirmationModal.vue_vue_type_script_setup_true_lang-DYFPnu_U.js";import{_ as te,r as H}from"./DesktopShell.vue_vue_type_script_setup_true_lang-Dx7t6K8R.js";import{u as se,_ as ae}from"./useIsMobile-kqNP1psy.js";import"./inputGuards-BV9ov3X1.js";import"./InstitutionAvatar.vue_vue_type_script_setup_true_lang-WZ7dJzJM.js";const le={class:"flex items-center gap-3 pt-2"},oe={class:"flex-1 text-xl font-semibold tracking-tight text-slate-900"},ie={class:"relative"},ne={key:0,class:"absolute right-0 mt-2 w-44 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg"},re={class:"mt-6 space-y-3"},de={key:0,class:"rounded-3xl bg-white p-5 shadow-sm ring-1 ring-slate-200/60"},ue={class:"mt-3 text-2xl font-semibold text-slate-900"},ce={class:"mt-5"},ve={class:"h-2 w-full overflow-hidden rounded-full bg-slate-200"},me={class:"mt-3 flex items-center justify-between text-xs font-medium text-slate-400"},xe={key:0,class:"mt-4 flex flex-wrap items-center gap-2 text-xs font-semibold text-slate-500"},fe=["title"],be=["title"],pe=["disabled"],ge={key:1,class:"rounded-3xl border border-dashed border-slate-200 bg-slate-50 px-5 py-8 text-center"},he={class:"rounded-3xl bg-white p-5 shadow-sm ring-1 ring-slate-200/60"},we={key:0,class:"mt-4 space-y-3"},ye={class:"text-sm font-semibold text-slate-900"},_e={class:"text-xs text-slate-400"},ke={key:1,class:"mt-4 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-6 text-center"},Ce={class:"space-y-6"},$e={class:"flex items-center justify-between gap-4"},Ee={class:"flex-1 text-2xl font-semibold text-slate-900"},De={class:"relative"},Ne={key:0,class:"absolute right-0 mt-2 w-44 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg"},je={class:"grid gap-6 xl:grid-cols-[420px_1fr]"},Be={key:0,class:"rounded-[28px] border border-white/70 bg-white p-6 shadow-[0_20px_50px_-40px_rgba(15,23,42,0.4)]"},Me={class:"mt-4 text-3xl font-semibold text-slate-900"},Se={class:"mt-8"},Fe={class:"h-2 w-full overflow-hidden rounded-full bg-slate-200"},Le={class:"mt-3 flex items-center justify-between text-xs font-medium text-slate-400"},Te={key:0,class:"mt-4 text-xs font-semibold text-slate-500"},Ve=["disabled"],Ae={key:1,class:"rounded-[28px] border border-dashed border-slate-200 bg-slate-50 p-6 text-center"},Re={class:"mt-4 rounded-[28px] border border-white/70 bg-white p-4 shadow-[0_20px_50px_-40px_rgba(15,23,42,0.4)]"},Oe={key:0,class:"space-y-4"},Pe={class:"flex items-center gap-4"},ze={class:"text-sm font-semibold text-slate-900"},Ie={class:"text-xs text-slate-500"},Ue={key:1,class:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-6 py-8 text-center"},W="ATENCAO: Isso ira excluir tambem todas as transacoes vinculadas a este cartao. Esta acao nao pode ser desfeita.",Ze=Z({__name:"CreditCard",setup(qe){const j=ee(),B=r(()=>j.props.bootstrap??{entries:[],goals:[],accounts:[],categories:[],tags:[]});r(()=>j.props.auth?.user?.name??"Gabriel");const K=se(),n=r(()=>B.value.accounts.find(a=>a.type==="credit_card")??null),h=r(()=>n.value?.name??"CartÃ£o"),k=r(()=>n.value?.credit_limit??0),v=r(()=>n.value?.current_balance??0),m=r(()=>n.value?.closing_day??null),x=r(()=>n.value?.due_day??null),f=r(()=>{if(!k.value)return 0;const a=v.value/k.value;return Math.min(100,Math.max(0,Math.round(a*100)))}),M=r(()=>k.value?Math.max(0,k.value-v.value):0),S=r(()=>f.value<50?"bg-emerald-500":f.value<80?"bg-amber-500":"bg-red-500"),d=y(!1),b=y(!1),c=y(!1),w=y(!1),D=y(""),C=a=>{D.value=a,w.value=!0},F=r(()=>`Tem certeza que deseja excluir o cartÃ£o "${h.value}"?`),L=r(()=>n.value?{id:String(n.value.id),nome:n.value.name??"CartÃ£o",bandeira:"visa",limite:Number(n.value.credit_limit??0),dia_fechamento:Number(n.value.closing_day??10),dia_vencimento:Number(n.value.due_day??17),cor:"#8B5CF6"}:null),T=async a=>{if(a.id)try{await H(`/api/cartoes/${a.id}`,{method:"PATCH",body:JSON.stringify(a)}),C("CartÃ£o atualizado"),U.reload()}catch{C("NÃ£o foi possÃ­vel salvar as alteraÃ§Ãµes")}},V=async()=>{if(n.value)try{await H(`/api/cartoes/${n.value.id}`,{method:"DELETE"}),C("CartÃ£o excluÃ­do"),U.visit(route("dashboard"))}catch{C("NÃ£o foi possÃ­vel excluir o cartÃ£o")}finally{c.value=!1}},Q=r(()=>B.value.entries??[]),X=a=>{const t=a.transactionDate?new Date(a.transactionDate):new Date,s=String(t.getDate()).padStart(2,"0"),Y=t.toLocaleString("pt-BR",{month:"short"}).replace(".","").toUpperCase();return`${s} ${Y}`},$=r(()=>Q.value.filter(a=>a.accountLabel===h.value).map(a=>({id:a.id,day:X(a),title:a.title,amount:a.amount,kind:a.kind,category:a.categoryLabel}))),p=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a);return(a,t)=>N(K)?(o(),A(ae,{key:0},{default:E(()=>[e("header",le,[u(N(R),{href:a.route("accounts.index"),class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white text-slate-600 shadow-sm ring-1 ring-slate-200/60","aria-label":"Voltar"},{default:E(()=>[...t[12]||(t[12]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),_:1},8,["href"]),e("div",oe,l(h.value),1),e("div",ie,[e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white text-slate-600 shadow-sm ring-1 ring-slate-200/60","aria-label":"AÃ§Ãµes",onClick:t[0]||(t[0]=s=>d.value=!d.value)}," â‹® "),d.value?(o(),i("div",ne,[e("button",{type:"button",class:"w-full px-4 py-3 text-left text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:t[1]||(t[1]=s=>{b.value=!0,d.value=!1})}," Editar cartÃ£o "),e("button",{type:"button",class:"w-full px-4 py-3 text-left text-sm font-semibold text-red-600 hover:bg-red-50",onClick:t[2]||(t[2]=s=>{c.value=!0,d.value=!1})}," Excluir cartÃ£o ")])):g("",!0)])]),e("div",re,[n.value?(o(),i("div",de,[t[13]||(t[13]=e("div",{class:"text-[11px] font-semibold uppercase tracking-wide text-slate-400"},"Fatura atual",-1)),e("div",ue,l(p(v.value)),1),e("div",ce,[e("div",ve,[e("div",{class:_(["h-2",S.value]),style:O({width:`${f.value}%`})},null,6)]),e("div",me,[e("div",null,"Usado: "+l(f.value)+"%",1),e("div",null,"DisponÃ­vel: "+l(p(M.value)),1)])]),m.value||x.value?(o(),i("div",xe,[m.value?(o(),i("span",{key:0,class:"inline-flex items-center rounded-md bg-slate-100 px-2 py-0.5 text-slate-600",title:`Fechamento dia ${m.value}`}," F "+l(m.value),9,fe)):g("",!0),x.value?(o(),i("span",{key:1,class:"inline-flex items-center rounded-md bg-slate-100 px-2 py-0.5 text-slate-600",title:`Vencimento dia ${x.value}`}," V "+l(x.value),9,be)):g("",!0)])):g("",!0),e("button",{class:"mt-5 w-full rounded-2xl bg-slate-900 py-3 text-sm font-semibold text-white disabled:opacity-60",type:"button",disabled:!v.value},"Pagar fatura",8,pe)])):(o(),i("div",ge,[...t[14]||(t[14]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Nenhum cartÃ£o cadastrado",-1),e("div",{class:"mt-1 text-xs text-slate-500"},"Cadastre um cartÃ£o para ver a fatura.",-1)])])),e("div",he,[t[16]||(t[16]=e("div",{class:"text-[11px] font-semibold uppercase tracking-wide text-slate-400"},"Extrato",-1)),$.value.length?(o(),i("div",we,[(o(!0),i(P,null,z($.value,s=>(o(),i("div",{key:s.id,class:"flex items-center justify-between"},[e("div",null,[e("div",ye,l(s.title),1),e("div",_e,l(s.category)+" â€¢ "+l(s.day),1)]),e("div",{class:_(["text-sm font-semibold",s.kind==="income"?"text-emerald-600":"text-slate-900"])},l(s.kind==="income"?"+":"-")+l(p(s.amount).replace("R$","R$")),3)]))),128))])):(o(),i("div",ke,[...t[15]||(t[15]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Sem lanÃ§amentos",-1),e("div",{class:"mt-1 text-xs text-slate-500"},"Adicione movimentaÃ§Ãµes para ver o extrato.",-1)])]))])]),u(J,{open:b.value,initial:L.value,onClose:t[3]||(t[3]=s=>b.value=!1),onSave:T},null,8,["open","initial"]),u(G,{open:c.value,title:"Excluir cartÃ£o de crÃ©dito?",message:F.value,warningText:W,danger:"",confirmLabel:"Excluir",onClose:t[4]||(t[4]=s=>c.value=!1),onConfirm:V},null,8,["open","message"]),u(q,{show:w.value,message:D.value,onDismiss:t[5]||(t[5]=s=>w.value=!1)},null,8,["show","message"])]),_:1})):(o(),A(te,{key:1,title:h.value,subtitle:"CartÃ£o de crÃ©dito","show-search":!1,"show-new-action":!1},{default:E(()=>[e("div",Ce,[e("div",$e,[u(N(R),{href:a.route("accounts.index"),class:"flex h-11 w-11 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm hover:bg-slate-50","aria-label":"Voltar"},{default:E(()=>[...t[17]||(t[17]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),_:1},8,["href"]),e("div",Ee,l(h.value),1),e("div",De,[e("button",{type:"button",class:"flex h-11 w-11 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm hover:bg-slate-50","aria-label":"AÃ§Ãµes",onClick:t[6]||(t[6]=s=>d.value=!d.value)}," â‹® "),d.value?(o(),i("div",Ne,[e("button",{type:"button",class:"w-full px-4 py-3 text-left text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:t[7]||(t[7]=s=>{b.value=!0,d.value=!1})}," Editar cartÃ£o "),e("button",{type:"button",class:"w-full px-4 py-3 text-left text-sm font-semibold text-red-600 hover:bg-red-50",onClick:t[8]||(t[8]=s=>{c.value=!0,d.value=!1})}," Excluir cartÃ£o ")])):g("",!0)])]),e("div",je,[n.value?(o(),i("div",Be,[t[19]||(t[19]=e("div",{class:"text-xs font-semibold uppercase tracking-wide text-slate-400"},"Fatura atual",-1)),e("div",Me,l(p(v.value)),1),e("div",Se,[e("div",Fe,[e("div",{class:_(["h-2",S.value]),style:O({width:`${f.value}%`})},null,6)]),e("div",Le,[e("div",null,"Usado: "+l(f.value)+"%",1),e("div",null,"DisponÃ­vel: "+l(p(M.value)),1)])]),m.value&&x.value?(o(),i("div",Te,[I(" ðŸ“… Fecha dia "+l(m.value)+" ",1),t[18]||(t[18]=e("span",{class:"text-slate-300"},"|",-1)),I(" Vence dia "+l(x.value),1)])):g("",!0),e("button",{class:"mt-8 w-full rounded-2xl py-3 text-sm font-semibold text-slate-900 disabled:opacity-60",type:"button",disabled:!v.value}," Pagar Fatura ",8,Ve)])):(o(),i("div",Ae,[...t[20]||(t[20]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Nenhum cartÃ£o cadastrado",-1),e("div",{class:"mt-1 text-xs text-slate-500"},"Cadastre um cartÃ£o para acompanhar a fatura.",-1)])])),e("div",null,[t[23]||(t[23]=e("div",{class:"px-2 text-xs font-semibold uppercase tracking-wide text-slate-400"},"Extrato de movimentaÃ§Ãµes",-1)),e("div",Re,[$.value.length?(o(),i("div",Oe,[(o(!0),i(P,null,z($.value,s=>(o(),i("div",{key:s.id,class:"flex items-center justify-between rounded-2xl px-4 py-5 shadow-sm"},[e("div",Pe,[e("span",{class:_(["flex h-12 w-12 items-center justify-center rounded-2xl",s.kind==="income"?"bg-emerald-50 text-emerald-600":"bg-red-50 text-red-500"])},[...t[21]||(t[21]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"5",y:"4",width:"14",height:"16",rx:"4"}),e("path",{d:"M8 8h8"})],-1)])],2),e("div",null,[e("div",ze,l(s.title),1),e("div",Ie,l(s.category)+" â€¢ "+l(s.day),1)])]),e("div",{class:_(["text-sm font-semibold",s.kind==="income"?"text-emerald-600":"text-slate-900"])},l(s.kind==="income"?"+":"-")+l(p(s.amount).replace("R$","R$")),3)]))),128))])):(o(),i("div",Ue,[...t[22]||(t[22]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Sem lanÃ§amentos",-1),e("div",{class:"mt-1 text-xs text-slate-500"},"Adicione movimentaÃ§Ãµes para ver o extrato.",-1)])]))])])])]),u(J,{open:b.value,initial:L.value,onClose:t[9]||(t[9]=s=>b.value=!1),onSave:T},null,8,["open","initial"]),u(G,{open:c.value,title:"Excluir cartÃ£o de crÃ©dito?",message:F.value,warningText:W,danger:"",confirmLabel:"Excluir",onClose:t[10]||(t[10]=s=>c.value=!1),onConfirm:V},null,8,["open","message"]),u(q,{show:w.value,message:D.value,onDismiss:t[11]||(t[11]=s=>w.value=!1)},null,8,["show","message"])]),_:1},8,["title"]))}});export{Ze as default};
