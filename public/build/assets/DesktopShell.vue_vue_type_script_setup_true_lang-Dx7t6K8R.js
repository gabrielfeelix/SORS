import{d as q,h as k,c as b,p as A,a as U,g as a,i as g,e,t as m,f as y,b as _,l as C,w as M,k as H,F as S,r as X,T as V,n as N,o,u as D,z as K,R as L,s as I,L as P}from"./app-nPHX7zkZ.js";import{b as z}from"./useIsMobile-kqNP1psy.js";const R=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",G=i=>{const x=`; ${document.cookie}`.split(`; ${i}=`);return x.length<2?"":x.pop().split(";").shift()??""},j=()=>{const i=G("XSRF-TOKEN");if(!i)return"";try{return decodeURIComponent(i)}catch{return i}},F=async()=>{if(!(await fetch("/sanctum/csrf-cookie",{credentials:"include"})).ok)throw new Error("Failed to refresh CSRF token");return{csrf:R(),xsrf:j()}},O=async(i,d={})=>{const x=async s=>{const c=String(d.method??"GET").toUpperCase(),v=["PATCH","PUT","DELETE"].includes(c),h={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":s.xsrf||s.csrf,...s.xsrf?{"X-XSRF-TOKEN":s.xsrf}:{},...v?{"X-HTTP-Method-Override":c}:{},...d.headers??{}};return fetch(i,{credentials:"include",...d,method:v?"POST":d.method??"GET",headers:h})};let l=await x({csrf:R(),xsrf:j()});if(l.status===419)try{const s=await F();l=await x(s)}catch{throw window.location.reload(),new Error("Session expired. Reloading page...")}if(!l.ok){const s=await l.text();throw new Error(s||`Request failed: ${l.status}`)}return await l.json()},Ie=async(i,d={})=>{const x=async s=>{const c=String(d.method??"GET").toUpperCase(),v=["PATCH","PUT","DELETE"].includes(c),w=s.xsrf||s.csrf,h=new Headers(d.headers??{});h.set("X-Requested-With","XMLHttpRequest"),h.set("X-CSRF-TOKEN",w),s.xsrf&&h.set("X-XSRF-TOKEN",s.xsrf),v&&h.set("X-HTTP-Method-Override",c);let u=d.body;if(v&&u instanceof FormData){const r=new FormData;for(const[f,T]of u.entries())r.append(f,T);r.set("_method",c),u=r}return fetch(i,{credentials:"include",...d,method:v?"POST":d.method??"GET",body:u,headers:h})};let l=await x({csrf:R(),xsrf:j()});if(l.status===419)try{const s=await F();l=await x(s)}catch{throw window.location.reload(),new Error("Session expired. Reloading page...")}if(!l.ok){const s=await l.text();throw new Error(s||`Request failed: ${l.status}`)}return await l.json()},Z={key:0,class:"fixed inset-0 z-[90]"},W={class:"absolute right-8 top-[76px] w-[420px] overflow-hidden rounded-3xl bg-white shadow-[0_30px_90px_-45px_rgba(15,23,42,0.55)] ring-1 ring-slate-200/60",role:"dialog","aria-modal":"true"},J={class:"flex items-center justify-between border-b border-slate-100 px-5 py-4"},Q={class:"mt-0.5 text-xs font-semibold text-slate-400"},Y={class:"flex items-center gap-2"},ee=["disabled"],te={class:"max-h-[420px] overflow-y-auto px-5 py-4"},se={key:0,class:"rounded-2xl bg-slate-50 px-4 py-10 text-center text-sm font-semibold text-slate-500 ring-1 ring-slate-100"},oe={key:1,class:"rounded-2xl bg-slate-50 px-4 py-10 text-center ring-1 ring-slate-100"},le={key:2,class:"space-y-3"},ae={class:"flex items-start justify-between gap-3"},re={class:"min-w-0"},ne={class:"mt-1 line-clamp-2 text-xs font-semibold text-slate-500"},ie={key:0,class:"mt-1 h-2 w-2 shrink-0 rounded-full bg-red-500"},de=q({__name:"DesktopNotificationsPopover",props:{open:{type:Boolean}},emits:["close","unread"],setup(i,{emit:d}){const x=i,l=d,s=k(!1),c=k([]),v=b(()=>c.value.filter(u=>!u.read_at).length),w=b(()=>c.value.slice(0,6)),h=async()=>{s.value=!0;try{const u=await O(route("api.notifications.index"));c.value=u.notifications??[],l("unread",v.value)}finally{s.value=!1}};return A(()=>x.open,u=>{u&&h()}),(u,r)=>(o(),U(V,{to:"body"},[i.open?(o(),a("div",Z,[e("button",{class:"absolute inset-0 bg-black/10",type:"button","aria-label":"Fechar",onClick:r[0]||(r[0]=f=>l("close"))}),e("section",W,[e("div",J,[e("div",null,[r[2]||(r[2]=e("div",{class:"text-sm font-semibold text-slate-900"},"Notificações",-1)),e("div",Q,m(v.value)+" não lidas",1)]),e("div",Y,[e("button",{type:"button",class:"rounded-2xl bg-slate-100 px-3 py-2 text-xs font-semibold text-slate-600 disabled:opacity-60",disabled:s.value,onClick:h}," Atualizar ",8,ee),y(_(C),{href:u.route("notifications.index"),class:"rounded-2xl bg-emerald-50 px-3 py-2 text-xs font-semibold text-emerald-700",onClick:r[1]||(r[1]=f=>l("close"))},{default:M(()=>[...r[3]||(r[3]=[H(" Ver todas ",-1)])]),_:1},8,["href"])])]),e("div",te,[s.value?(o(),a("div",se," Carregando… ")):w.value.length===0?(o(),a("div",oe,[...r[4]||(r[4]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Sem notificações",-1),e("div",{class:"mt-1 text-xs font-semibold text-slate-500"},"Quando algo importante acontecer, avisamos por aqui.",-1)])])):(o(),a("div",le,[(o(!0),a(S,null,X(w.value,f=>(o(),a("div",{key:f.id,class:"rounded-2xl bg-white px-4 py-3 ring-1 ring-slate-200/60"},[e("div",ae,[e("div",re,[e("div",{class:N(["truncate text-sm font-semibold",f.read_at?"text-slate-700":"text-slate-900"])},m(f.title),3),e("div",ne,m(f.body),1)]),f.read_at?g("",!0):(o(),a("span",ie))])]))),128))]))])])])):g("",!0)]))}}),ce={class:"min-h-screen bg-slate-50"},ue={class:"flex min-h-screen"},he={class:"hidden w-[280px] flex-col border-r border-slate-200/70 bg-white md:flex"},fe={class:"mt-8 flex-1 space-y-2 px-5","aria-label":"Menu principal"},pe={key:0,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},xe={key:1,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ve={key:2,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},we={key:3,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},me={key:4,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ge={key:5,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},be={class:"text-sm font-semibold"},ye={key:0,class:"ml-auto h-9 w-1.5 rounded-full bg-[#14B8A6]"},ke={class:"px-5 pb-6"},_e={class:"flex items-center justify-between rounded-2xl bg-white px-4 py-4 ring-1 ring-slate-200/60"},Ce={class:"flex items-center gap-3"},Me={class:"flex h-11 w-11 items-center justify-center overflow-hidden rounded-full bg-slate-200 text-sm font-bold text-slate-700"},Te=["src"],$e={key:1},Be={class:"leading-tight"},Ee={class:"text-sm font-semibold text-slate-900"},Se={class:"flex min-w-0 flex-1 flex-col"},Ne={class:"sticky top-0 z-30 border-b border-slate-200/70 bg-white/80 backdrop-blur"},Re={class:"flex items-center justify-between gap-4 px-6 py-4 md:px-10"},je={key:0,class:"text-lg font-semibold text-slate-900"},Pe={key:1,class:"text-sm font-medium text-slate-400"},qe={class:"flex items-center gap-3"},Ue={key:0,class:"hidden items-center gap-2 rounded-2xl bg-slate-50 px-4 py-2 ring-1 ring-slate-200/60 md:flex"},Xe=["placeholder"],Fe=["aria-expanded"],Oe={key:0,class:"absolute right-2.5 top-2.5 h-2 w-2 rounded-full bg-red-500"},Ae=["src"],He={key:1},Ve={class:"flex-1 px-6 py-8 md:px-10"},De={class:"mx-auto w-full max-w-[1100px]"},ze=q({__name:"DesktopShell",props:{title:{default:""},subtitle:{default:""},showSearch:{type:Boolean,default:!0},searchPlaceholder:{default:"Buscar…"},showNewAction:{type:Boolean,default:!0},newActionLabel:{default:"Nova Transação"}},emits:["add"],setup(i,{emit:d}){const x=d,l=i,s=D(),c=b(()=>String(s.props?.auth?.user?.name??"")),v=b(()=>c.value.trim().split(/\s+/)[0]??c.value),w=b(()=>s.props?.auth?.user?.avatar_url??s.props?.auth?.user?.profile_photo_url??null),h=b(()=>{const p=c.value.trim().split(/\s+/).filter(Boolean),t=p[0]?.[0]??"K",n=p.length>1?p[p.length-1]?.[0]:"";return`${t}${n}`.toUpperCase()}),u=b(()=>[{label:"Painel",href:route("dashboard"),active:route().current("dashboard"),icon:"dashboard"},{label:"Minhas Contas",href:route("accounts.overview"),active:route().current("accounts.overview"),icon:"accounts"},{label:"Transações",href:route("accounts.index"),active:route().current("accounts.*")&&!route().current("accounts.overview"),icon:"cards"},{label:"Cartões de crédito",href:route("credit-cards.my-cards"),active:route().current("credit-cards.*"),icon:"credit"},{label:"Metas",href:route("goals.index"),active:route().current("goals.*"),icon:"target"},{label:"Relatórios",href:route("analysis"),active:route().current("analysis*"),icon:"chart"}]),r=k(!1),f=k(0),T=p=>{f.value=p},$=k(!1),B=async()=>{try{const p=await O(route("api.notifications.count-unread"));f.value=Number(p.count??0)}catch{}};let E=null;return K(()=>{B(),E=window.setInterval(B,6e4)}),L(()=>{E&&window.clearInterval(E)}),(p,t)=>(o(),a(S,null,[e("div",ce,[e("div",ue,[e("aside",he,[t[14]||(t[14]=e("div",{class:"px-7 pt-7"},[e("div",{class:"flex items-center gap-3"},[e("div",{class:"flex h-12 w-12 items-center justify-center rounded-2xl bg-[#14B8A6] text-xl font-bold text-white"}," K "),e("div",{class:"text-xl font-semibold tracking-tight text-slate-900"},"Kitamo")])],-1)),e("nav",fe,[(o(!0),a(S,null,X(u.value,n=>(o(),U(_(C),{key:n.label,href:n.href,class:N(["group flex items-center gap-4 rounded-2xl px-4 py-3.5 ring-1 ring-transparent transition",n.active?"bg-emerald-50 text-slate-900 ring-emerald-100":"text-slate-500 hover:bg-slate-50 hover:text-slate-700"])},{default:M(()=>[e("span",{class:N(["flex h-11 w-11 items-center justify-center rounded-2xl",n.active?"bg-white text-emerald-600 ring-1 ring-emerald-100":"bg-slate-100 text-slate-400"])},[n.icon==="dashboard"?(o(),a("svg",pe,[...t[5]||(t[5]=[e("rect",{x:"3",y:"3",width:"7",height:"7",rx:"2"},null,-1),e("rect",{x:"14",y:"3",width:"7",height:"7",rx:"2"},null,-1),e("rect",{x:"3",y:"14",width:"7",height:"7",rx:"2"},null,-1),e("rect",{x:"14",y:"14",width:"7",height:"7",rx:"2"},null,-1)])])):n.icon==="cards"?(o(),a("svg",xe,[...t[6]||(t[6]=[e("rect",{x:"3",y:"5",width:"18",height:"14",rx:"3"},null,-1),e("path",{d:"M3 10h18"},null,-1)])])):n.icon==="target"?(o(),a("svg",ve,[...t[7]||(t[7]=[e("circle",{cx:"12",cy:"12",r:"8"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1),e("path",{d:"M12 2v3"},null,-1),e("path",{d:"M22 12h-3"},null,-1),e("path",{d:"M12 22v-3"},null,-1),e("path",{d:"M2 12h3"},null,-1)])])):n.icon==="accounts"?(o(),a("svg",we,[...t[8]||(t[8]=[e("path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"},null,-1),e("path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5"},null,-1),e("path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z"},null,-1)])])):n.icon==="credit"?(o(),a("svg",me,[...t[9]||(t[9]=[e("rect",{x:"2",y:"5",width:"20",height:"14",rx:"3"},null,-1),e("path",{d:"M2 10h20"},null,-1)])])):(o(),a("svg",ge,[...t[10]||(t[10]=[e("path",{d:"M4 19V5"},null,-1),e("path",{d:"M10 19V9"},null,-1),e("path",{d:"M16 19v-4"},null,-1),e("path",{d:"M22 19V7"},null,-1)])]))],2),e("span",be,m(n.label),1),n.active?(o(),a("span",ye)):g("",!0)]),_:2},1032,["href","class"]))),128)),e("button",{type:"button",class:"group flex w-full items-center gap-4 rounded-2xl px-4 py-3.5 text-slate-500 transition hover:bg-slate-50 hover:text-slate-700","aria-label":"Menu",onClick:t[0]||(t[0]=n=>$.value=!0)},[...t[11]||(t[11]=[I('<span class="flex h-11 w-11 items-center justify-center rounded-2xl bg-slate-100 text-slate-400"><svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 6h16"></path><path d="M4 12h16"></path><path d="M4 18h16"></path></svg></span><span class="text-sm font-semibold">Menu</span>',2)])])]),e("div",ke,[e("div",_e,[e("div",Ce,[e("div",Me,[w.value?(o(),a("img",{key:0,src:w.value,alt:"",class:"h-full w-full object-cover"},null,8,Te)):(o(),a("span",$e,m(h.value),1))]),e("div",Be,[e("div",Ee,m(v.value||"Usuário"),1),t[12]||(t[12]=e("div",{class:"text-xs font-medium text-slate-400"},"Plano UI/UX",-1))])]),y(_(C),{href:p.route("settings"),class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-50 text-slate-600 ring-1 ring-slate-200/60","aria-label":"Configurações"},{default:M(()=>[...t[13]||(t[13]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 15.5A3.5 3.5 0 1 0 12 8.5a3.5 3.5 0 0 0 0 7Z"}),e("path",{d:"M19.4 15a7.9 7.9 0 0 0 .1-1 7.9 7.9 0 0 0-.1-1l2-1.6-2-3.4-2.4 1a7.4 7.4 0 0 0-1.7-1l-.4-2.6H9.1L8.7 8a7.4 7.4 0 0 0-1.7 1l-2.4-1-2 3.4 2 1.6a7.9 7.9 0 0 0-.1 1 7.9 7.9 0 0 0 .1 1l-2 1.6 2 3.4 2.4-1a7.4 7.4 0 0 0 1.7 1l.4 2.6h5.8l.4-2.6a7.4 7.4 0 0 0 1.7-1l2.4 1 2-3.4-2-1.6Z"})],-1)])]),_:1},8,["href"])])])]),e("div",Se,[e("header",Ne,[e("div",Re,[e("div",null,[l.title?(o(),a("div",je,m(l.title),1)):g("",!0),l.subtitle?(o(),a("div",Pe,m(l.subtitle),1)):g("",!0)]),e("div",qe,[l.showSearch?(o(),a("div",Ue,[t[15]||(t[15]=e("svg",{class:"h-5 w-5 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"11",cy:"11",r:"7"}),e("path",{d:"M21 21l-4.3-4.3"})],-1)),e("input",{type:"text",placeholder:l.searchPlaceholder,class:"w-[260px] bg-transparent text-sm font-semibold text-slate-700 placeholder:text-slate-400 focus:outline-none"},null,8,Xe)])):g("",!0),P(p.$slots,"headerActions"),e("button",{type:"button",class:"relative flex h-11 w-11 items-center justify-center rounded-2xl bg-white text-slate-600 ring-1 ring-slate-200/60","aria-label":"Notificações","aria-expanded":r.value?"true":"false",onClick:t[1]||(t[1]=n=>r.value=!r.value)},[t[16]||(t[16]=e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 7 3 7H3s3 0 3-7"}),e("path",{d:"M10 21a2 2 0 0 0 4 0"})],-1)),f.value>0?(o(),a("span",Oe)):g("",!0)],8,Fe),y(_(C),{href:p.route("settings"),class:"flex h-11 w-11 items-center justify-center overflow-hidden rounded-2xl bg-slate-200 text-sm font-bold text-slate-700 ring-1 ring-slate-200/60","aria-label":"Perfil"},{default:M(()=>[w.value?(o(),a("img",{key:0,src:w.value,alt:"",class:"h-full w-full object-cover"},null,8,Ae)):(o(),a("span",He,m(h.value),1))]),_:1},8,["href"]),l.showNewAction?(o(),a("button",{key:1,type:"button",class:"h-11 w-11 items-center justify-center rounded-full bg-[#14B8A6] text-white shadow-xl shadow-emerald-500/30 ring-1 ring-emerald-400/20 md:inline-flex","aria-label":"Nova transação",onClick:t[2]||(t[2]=n=>x("add"))},[...t[17]||(t[17]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14"}),e("path",{d:"M5 12h14"})],-1)])])):g("",!0)])])]),e("main",Ve,[e("div",De,[P(p.$slots,"default")])])])])]),y(de,{open:r.value,onClose:t[3]||(t[3]=()=>{r.value=!1,B()}),onUnread:T},null,8,["open"]),y(z,{open:$.value,onClose:t[4]||(t[4]=n=>$.value=!1)},null,8,["open"])],64))}});export{ze as _,Ie as a,O as r};
