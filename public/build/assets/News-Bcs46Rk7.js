import{d as H,c as y,h as x,J as E,g as r,f as C,a as J,b as a,D as K,w as M,e,t as i,x as n,o as d,F as A,r as j,K as b,I as p,i as T,n as P,G as O,H as W,C as Q,m as S}from"./app-Pd0ejbZJ.js";import{u as X,_ as Y}from"./useIsMobile-CRomRP0o.js";import{_ as Z}from"./DesktopShell.vue_vue_type_script_setup_true_lang-CaKEcI4E.js";import{_ as ee}from"./AdminHeader.vue_vue_type_script_setup_true_lang-BMtTlgrr.js";import{_ as te}from"./Modal.vue_vue_type_script_setup_true_lang-DjEikzG1.js";const se={class:"space-y-4"},le={class:"rounded-3xl bg-white p-6 shadow-sm ring-1 ring-slate-200/60"},oe={class:"flex flex-wrap items-center justify-between gap-3"},ae={class:"mt-1 text-xs font-semibold text-slate-400"},ne={class:"mt-5 grid gap-3 md:grid-cols-[1fr_1fr_1fr_1.2fr]"},de={class:"block"},re=["value"],ie={class:"block"},ue={class:"block"},pe={class:"block"},xe={class:"mt-2 flex h-11 items-center gap-2 rounded-xl border border-slate-200 bg-white px-4"},be={key:0,class:"mt-6 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-10 text-center"},ce={key:1,class:"mt-6 space-y-3"},me={class:"flex flex-wrap items-start justify-between gap-3"},ve={class:"min-w-0"},fe={class:"flex flex-wrap items-center gap-2"},ge={class:"truncate text-base font-semibold text-slate-900"},ye={class:"mt-1 text-xs font-semibold text-slate-500"},we={key:0},he={key:1},_e={key:2},ke={key:3},Ce={class:"flex flex-wrap items-center gap-2"},Ae=["onClick"],Te=["onClick"],Se={key:0,class:"mt-3 rounded-xl bg-red-50 p-3 ring-1 ring-red-100"},Ve={class:"mt-2 flex justify-end gap-2"},Ue=["disabled","onClick"],Be={class:"p-6"},Ne={class:"flex items-start justify-between gap-4"},$e={class:"text-lg font-semibold text-slate-900"},Ee={class:"mt-5 grid gap-4 md:grid-cols-2"},Me={class:"block md:col-span-2"},je={class:"block md:col-span-2"},Pe={class:"block"},De={class:"block"},Re={class:"block"},Fe={class:"block"},Ie={class:"block md:col-span-2"},Le={class:"block md:col-span-2"},qe={class:"block"},ze={class:"block"},Ge={key:0,class:"mt-4 rounded-2xl bg-red-50 p-4 text-sm font-semibold text-red-700"},He={class:"mt-6 flex items-center justify-end gap-2"},Je=["disabled"],Ye=H({__name:"News",props:{items:{}},setup(D){const V=D,U=X(),R=y(()=>U.value?Y:Z),F=y(()=>U.value?{showNav:!1}:{title:"Administração",showSearch:!1,showNewAction:!1}),v=x("Todas"),f=x("Todos"),g=x("Todos"),w=x(""),I=y(()=>{const l=new Set;for(const t of V.items)t.category&&l.add(t.category);return["Todas",...Array.from(l.values()).sort((t,s)=>t.localeCompare(s))]}),h=y(()=>{const l=w.value.trim().toLowerCase();return V.items.filter(t=>v.value!=="Todas"&&(t.category||"")!==v.value||f.value!=="Todos"&&t.status!==f.value||g.value!=="Todos"&&t.type!==g.value?!1:l?`${t.title} ${t.content||""} ${t.category||""}`.toLowerCase().includes(l):!0)}),_=l=>{if(!l)return"";const t=new Date(l);return Number.isFinite(t.getTime())?t.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):String(l)},B=l=>l==="published"?{label:"Publicado",cls:"bg-emerald-50 text-emerald-700"}:l==="scheduled"?{label:"Agendado",cls:"bg-amber-50 text-amber-700"}:{label:"Rascunho",cls:"bg-slate-100 text-slate-700"},N=l=>l==="fix"?{label:"Correção",cls:"bg-red-50 text-red-700"}:l==="improvement"?{label:"Melhoria",cls:"bg-blue-50 text-blue-700"}:l==="announcement"?{label:"Aviso",cls:"bg-amber-50 text-amber-700"}:{label:"Novo",cls:"bg-emerald-50 text-emerald-700"},u=x(!1),c=x(null),o=E({title:"",category:"",type:"new",visibility:"public",status:"draft",scheduled_at:"",content:"",image_url:"",cta_text:"",cta_url:""}),L=()=>{c.value=null,o.reset(),o.clearErrors(),u.value=!0},q=l=>{c.value=l.id,o.reset(),o.clearErrors(),o.title=l.title,o.category=l.category??"",o.type=l.type||"new",o.visibility=l.visibility||"public",o.status=l.status||"draft",o.scheduled_at=l.scheduled_at?l.scheduled_at.slice(0,16):"",o.content=l.content??"",o.image_url=l.image_url??"",o.cta_text=l.cta_text??"",o.cta_url=l.cta_url??"",u.value=!0},z=()=>{if(o.transform(l=>({title:l.title,category:l.category||null,type:l.type,visibility:l.visibility,status:l.status,scheduled_at:l.scheduled_at||null,content:l.content||null,image_url:l.image_url||null,cta_text:l.cta_text||null,cta_url:l.cta_url||null})),c.value){o.patch(route("admin.news.update",c.value),{preserveScroll:!0,onSuccess:()=>{u.value=!1,S.reload({only:["items"]})}});return}o.post(route("admin.news.store"),{preserveScroll:!0,onSuccess:()=>{u.value=!1,S.reload({only:["items"]})}})},m=x(null),$=E({}),G=l=>{$.delete(route("admin.news.destroy",l),{preserveScroll:!0,onSuccess:()=>{m.value=null,S.reload({only:["items"]})}})};return(l,t)=>(d(),r(A,null,[C(a(K),{title:"Administração · Novidades"}),(d(),J(Q(R.value),O(W(F.value)),{default:M(()=>[e("div",se,[C(ee,{description:"Crie e publique novidades do sistema (modal de novidades para usuários)."}),e("div",le,[e("div",oe,[e("div",null,[t[18]||(t[18]=e("div",{class:"text-sm font-semibold text-slate-900"},"Changelog",-1)),e("div",ae,i(h.value.length)+" item(ns)",1)]),e("div",{class:"flex flex-wrap items-center gap-2"},[e("button",{type:"button",class:"inline-flex items-center justify-center rounded-2xl bg-[#14B8A6] px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20",onClick:L}," + Adicionar novidade ")])]),e("div",ne,[e("label",de,[t[19]||(t[19]=e("div",{class:"text-xs font-semibold text-slate-500"},"Categoria",-1)),n(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[(d(!0),r(A,null,j(I.value,s=>(d(),r("option",{key:s,value:s},i(s),9,re))),128))],512),[[b,v.value]])]),e("label",ie,[t[21]||(t[21]=e("div",{class:"text-xs font-semibold text-slate-500"},"Status",-1)),n(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...t[20]||(t[20]=[e("option",{value:"Todos"},"Todos",-1),e("option",{value:"draft"},"Rascunho",-1),e("option",{value:"scheduled"},"Agendado",-1),e("option",{value:"published"},"Publicado",-1)])],512),[[b,f.value]])]),e("label",ue,[t[23]||(t[23]=e("div",{class:"text-xs font-semibold text-slate-500"},"Tipo",-1)),n(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>g.value=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...t[22]||(t[22]=[e("option",{value:"Todos"},"Todos",-1),e("option",{value:"new"},"Novo",-1),e("option",{value:"improvement"},"Melhoria",-1),e("option",{value:"fix"},"Correção",-1),e("option",{value:"announcement"},"Aviso",-1)])],512),[[b,g.value]])]),e("label",pe,[t[25]||(t[25]=e("div",{class:"text-xs font-semibold text-slate-500"},"Buscar",-1)),e("div",xe,[t[24]||(t[24]=e("svg",{class:"h-5 w-5 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"11",cy:"11",r:"7"}),e("path",{d:"M21 21l-4.3-4.3"})],-1)),n(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>w.value=s),type:"text",class:"w-full appearance-none border-0 bg-transparent p-0 text-sm font-semibold text-slate-800 placeholder:text-slate-400 outline-none focus:outline-none focus:ring-0",placeholder:"Buscar por título/conteúdo"},null,512),[[p,w.value]])])])]),h.value.length===0?(d(),r("div",be,[...t[26]||(t[26]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Nenhuma novidade encontrada",-1),e("div",{class:"mt-2 text-xs font-semibold text-slate-500"},"Ajuste os filtros ou crie uma novidade.",-1)])])):(d(),r("div",ce,[(d(!0),r(A,null,j(h.value,s=>(d(),r("div",{key:s.id,class:"rounded-2xl bg-slate-50 p-4 ring-1 ring-slate-200/60"},[e("div",me,[e("div",ve,[e("div",fe,[e("div",ge,i(s.title),1),e("span",{class:P(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",N(s.type).cls])},i(N(s.type).label),3),e("span",{class:P(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",B(s.status).cls])},i(B(s.status).label),3)]),e("div",ye,[s.category?(d(),r("span",we,i(s.category)+" • ",1)):T("",!0),s.published_at?(d(),r("span",he,"Publicado em "+i(_(s.published_at)),1)):s.scheduled_at?(d(),r("span",_e,"Agendado para "+i(_(s.scheduled_at)),1)):(d(),r("span",ke,"Criado em "+i(_(s.created_at)),1))])]),e("div",Ce,[e("button",{type:"button",class:"rounded-xl bg-white px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200/60 hover:bg-slate-50",onClick:k=>q(s)}," Editar ",8,Ae),e("button",{type:"button",class:"rounded-xl bg-red-50 px-3 py-2 text-xs font-semibold text-red-700 ring-1 ring-red-100 hover:bg-red-100",onClick:k=>m.value=m.value===s.id?null:s.id}," Excluir ",8,Te)])]),m.value===s.id?(d(),r("div",Se,[t[27]||(t[27]=e("div",{class:"text-xs font-semibold text-red-700"},"Tem certeza que deseja excluir?",-1)),e("div",Ve,[e("button",{type:"button",class:"px-3 py-2 text-xs font-semibold text-slate-600",onClick:t[4]||(t[4]=k=>m.value=null)},"Cancelar"),e("button",{type:"button",class:"rounded-xl bg-red-600 px-3 py-2 text-xs font-semibold text-white disabled:opacity-60",disabled:a($).processing,onClick:k=>G(s.id)}," Excluir agora ",8,Ue)])])):T("",!0)]))),128))]))])])]),_:1},16)),C(te,{show:u.value,maxWidth:"2xl",onClose:t[17]||(t[17]=s=>u.value=!1)},{default:M(()=>[e("div",Be,[e("div",Ne,[e("div",null,[e("div",$e,i(c.value?"Editar novidade":"Nova novidade"),1),t[28]||(t[28]=e("div",{class:"mt-1 text-sm text-slate-500"},"Isso aparece no modal de novidades para os usuários.",-1))]),e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-50 text-slate-600 ring-1 ring-slate-200/60","aria-label":"Fechar",onClick:t[5]||(t[5]=s=>u.value=!1)},[...t[29]||(t[29]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M6 6l12 12"}),e("path",{d:"M18 6l-12 12"})],-1)])])]),e("div",Ee,[e("label",Me,[t[30]||(t[30]=e("div",{class:"text-xs font-semibold text-slate-500"},"Título *",-1)),n(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>a(o).title=s),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"Ex.: Melhorias na Estante"},null,512),[[p,a(o).title]])]),e("label",je,[t[31]||(t[31]=e("div",{class:"text-xs font-semibold text-slate-500"},"Categoria (opcional)",-1)),n(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a(o).category=s),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"Ex.: Biblioteca, Perfil, Admin..."},null,512),[[p,a(o).category]])]),e("label",Pe,[t[33]||(t[33]=e("div",{class:"text-xs font-semibold text-slate-500"},"Tipo",-1)),n(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>a(o).type=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...t[32]||(t[32]=[e("option",{value:"new"},"Novo",-1),e("option",{value:"improvement"},"Melhoria",-1),e("option",{value:"fix"},"Correção",-1),e("option",{value:"announcement"},"Aviso",-1)])],512),[[b,a(o).type]])]),e("label",De,[t[35]||(t[35]=e("div",{class:"text-xs font-semibold text-slate-500"},"Visibilidade",-1)),n(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>a(o).visibility=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...t[34]||(t[34]=[e("option",{value:"public"},"Público",-1),e("option",{value:"admin"},"Apenas admin",-1)])],512),[[b,a(o).visibility]])]),e("label",Re,[t[37]||(t[37]=e("div",{class:"text-xs font-semibold text-slate-500"},"Status",-1)),n(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>a(o).status=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...t[36]||(t[36]=[e("option",{value:"draft"},"Rascunho",-1),e("option",{value:"scheduled"},"Agendado",-1),e("option",{value:"published"},"Publicado",-1)])],512),[[b,a(o).status]])]),e("label",Fe,[t[38]||(t[38]=e("div",{class:"text-xs font-semibold text-slate-500"},"Agendar para (opcional)",-1)),n(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>a(o).scheduled_at=s),type:"datetime-local",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800"},null,512),[[p,a(o).scheduled_at]])]),e("label",Ie,[t[39]||(t[39]=e("div",{class:"text-xs font-semibold text-slate-500"},"Conteúdo",-1)),n(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=s=>a(o).content=s),rows:"7",class:"mt-2 w-full resize-none appearance-none rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-800",placeholder:"Descreva a novidade..."},null,512),[[p,a(o).content]])]),e("label",Le,[t[40]||(t[40]=e("div",{class:"text-xs font-semibold text-slate-500"},"Imagem (URL opcional)",-1)),n(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>a(o).image_url=s),type:"url",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"https://..."},null,512),[[p,a(o).image_url]])]),e("label",qe,[t[41]||(t[41]=e("div",{class:"text-xs font-semibold text-slate-500"},"CTA (texto opcional)",-1)),n(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>a(o).cta_text=s),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"Saiba mais"},null,512),[[p,a(o).cta_text]])]),e("label",ze,[t[42]||(t[42]=e("div",{class:"text-xs font-semibold text-slate-500"},"CTA (URL opcional)",-1)),n(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>a(o).cta_url=s),type:"url",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"https://..."},null,512),[[p,a(o).cta_url]])])]),a(o).hasErrors?(d(),r("div",Ge," Não foi possível salvar. Verifique os campos. ")):T("",!0),e("div",He,[e("button",{type:"button",class:"rounded-xl px-4 py-2 text-sm font-semibold text-slate-600",onClick:t[16]||(t[16]=s=>u.value=!1)},"Cancelar"),e("button",{type:"button",class:"rounded-xl bg-[#14B8A6] px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20 disabled:opacity-60",disabled:a(o).processing,onClick:z},i(a(o).processing?"Salvando…":"Salvar"),9,Je)])])]),_:1},8,["show"])],64))}});export{Ye as default};
