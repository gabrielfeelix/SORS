import{d as V,c as i,u as J,h as n,g as r,f as g,a as N,b as v,D as K,w as _,e as s,o as l,l as B,F as T,r as E,n as m,t as c,k as G,j as Z,B as H,C as Q,m as A}from"./app-BblmX-k6.js";import{_ as U,a as W,r as X}from"./DesktopShell.vue_vue_type_script_setup_true_lang-CbAI3--o.js";import{T as Y,e as ee,h as F,b as te,a as se}from"./TransactionModal-BtEOqaMR.js";import{u as ae,_ as oe}from"./useIsMobile-DqUvSeEk.js";import"./inputGuards-BV9ov3X1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AccountPickerSheet.vue_vue_type_script_setup_true_lang-BA27uhS1.js";const ne={class:"flex items-center justify-between pt-2"},le={key:0,class:"text-2xl font-semibold tracking-tight text-slate-900"},re={key:1,class:"text-lg font-semibold text-slate-900"},ie={key:0,class:"mt-6 rounded-3xl border border-dashed border-slate-200 bg-white px-5 py-8 text-center shadow-sm"},ce={key:1,class:"mt-6 space-y-4 pb-4"},ue={class:"flex items-start gap-4"},de={key:0,class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},me={key:1,class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},fe={key:2,class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ve={class:"flex-1"},pe={class:"flex items-start justify-between gap-3"},be={class:"text-base font-semibold text-slate-900"},he={class:"mt-1 text-xs font-semibold text-slate-400"},xe={class:"mt-4 flex items-center justify-between text-sm font-semibold"},ge={class:"text-slate-400"},_e={class:"mt-3 h-2 w-full rounded-full bg-slate-100"},ke={class:"mt-3 text-right text-[10px] font-semibold text-slate-400"},Fe=V({__name:"Index",setup(we){const p=ae(),R=i(()=>p.value?oe:U),S=i(()=>p.value?{showNav:!0}:{title:"Metas",showSearch:!1,showNewAction:!1}),$=J(),u=i(()=>$.props.bootstrap??{entries:[],goals:[],accounts:[],categories:[],tags:[]}),j=i(()=>{const t=new Map;for(const a of u.value.categories??[]){const e=a.type==="income"?"income":a.type==="expense"?"expense":void 0,o=t.get(a.name),f=o?.kind&&e&&o.kind!==e?void 0:o?.kind??e;t.set(a.name,{key:a.name,label:a.name,icon:"other",tone:"slate",kind:f})}return Array.from(t.values())}),D=i(()=>{const t=e=>{const o=e.toLowerCase();return o.includes("nubank")?"purple":o.includes("inter")?"amber":o.includes("carteira")||o.includes("dinheiro")?"emerald":"slate"},a=[];for(const e of u.value.accounts??[])e.type!=="credit_card"&&a.push({key:e.name,label:e.name,subtitle:e.type==="wallet"?"Carteira":"Conta",tone:t(e.name),type:e.type,balance:Number(e.current_balance??0),customColor:e.color??void 0,icon:e.icon??void 0});for(const e of u.value.accounts??[]){if(e.type!=="credit_card")continue;const o=Number(e.credit_limit??0),f=Math.max(0,Number(e.current_balance??0));a.push({key:e.name,label:e.name,subtitle:"Cartão de Crédito",tone:t(e.name),type:"credit_card",limit:o,used:f,available:o-f,customColor:e.color??void 0,icon:e.icon??void 0})}return a}),d=n(u.value.goals??[]),k=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0}).format(t),w=t=>t.target?Math.min(100,Math.round(t.current/t.target*100)):0,y={on_track:{label:"No ritmo",cls:"bg-emerald-50 text-emerald-600",dot:"bg-emerald-500"},ahead:{label:"Adiantado",cls:"bg-blue-50 text-blue-600",dot:"bg-blue-500"},late:{label:"Atrasado",cls:"bg-red-50 text-red-500",dot:"bg-red-500"}},b=t=>y[t]??y.on_track,M=n("all");i(()=>M.value==="all"?d.value:d.value.filter(t=>(t.term??"long")===M.value)),n(!1);const C=n(null);i(()=>C.value?d.value.find(t=>t.id===C.value)??null:null),n(!1),n(!1);const h=n(!1),I=n("expense"),P=n(null),z=()=>{A.visit(route("goals.create"))},q=n(!1),L=n(""),x=t=>{L.value=t,q.value=!0},O=async t=>{if(t.kind==="transfer"){try{await ee(t),x("Transferência realizada"),A.reload({only:["bootstrap"]})}catch{x("Não foi possível realizar a transferência")}return}await(F(t)?W:X)(route("transactions.store"),{method:"POST",body:F(t)?te(t):JSON.stringify(se(t))}),h.value=!1,x("Movimentação salva")};return(t,a)=>(l(),r(T,null,[g(v(K),{title:"Metas"}),(l(),N(Q(R.value),H(S.value,{onAdd:z}),{default:_(()=>[s("header",ne,[v(p)?(l(),r("div",le,"Metas")):(l(),r("div",re,"Metas"))]),d.value.length===0?(l(),r("div",ie,[g(v(B),{href:t.route("goals.create"),class:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-slate-50 text-slate-400","aria-label":"Nova meta"},{default:_(()=>[...a[1]||(a[1]=[s("svg",{class:"h-8 w-8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M12 5v14"}),s("path",{d:"M5 12h14"})],-1)])]),_:1},8,["href"]),a[2]||(a[2]=s("div",{class:"mt-4 text-base font-semibold text-slate-900"},"Nova meta",-1)),a[3]||(a[3]=s("div",{class:"mt-2 text-sm text-slate-500"},"Crie um objetivo financeiro e acompanhe o progresso.",-1))])):(l(),r("div",ce,[(l(!0),r(T,null,E(d.value,e=>(l(),N(v(B),{key:e.id,href:t.route("goals.show",{goalId:e.id}),class:"block rounded-3xl bg-white p-5 shadow-sm ring-1 ring-slate-200/60"},{default:_(()=>[s("div",ue,[s("span",{class:m(["flex h-12 w-12 items-center justify-center rounded-2xl",e.icon==="home"?"bg-emerald-50 text-emerald-600":e.icon==="plane"?"bg-blue-50 text-blue-600":"bg-orange-50 text-orange-500"])},[e.icon==="home"?(l(),r("svg",de,[...a[4]||(a[4]=[s("path",{d:"M3 10.5L12 3l9 7.5"},null,-1),s("path",{d:"M5 10v10h14V10"},null,-1)])])):e.icon==="plane"?(l(),r("svg",me,[...a[5]||(a[5]=[s("path",{d:"M2 16l20-8-20-8 6 8-6 8Z"},null,-1),s("path",{d:"M6 16v6l4-4"},null,-1)])])):(l(),r("svg",fe,[...a[6]||(a[6]=[s("path",{d:"M5 16l1-5 1-3h10l1 3 1 5"},null,-1),s("path",{d:"M7 16h10"},null,-1),s("circle",{cx:"8",cy:"17",r:"1.5"},null,-1),s("circle",{cx:"16",cy:"17",r:"1.5"},null,-1)])]))],2),s("div",ve,[s("div",pe,[s("div",null,[s("div",be,c(e.title),1),s("div",he,"Prazo: "+c(e.due),1)]),s("span",{class:m(["inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold",b(e.status).cls])},[s("span",{class:m(["h-2 w-2 rounded-full",b(e.status).dot])},null,2),G(" "+c(b(e.status).label),1)],2)]),s("div",xe,[s("div",{class:m(e.status==="late"?"text-orange-500":"text-[#14B8A6]")},c(k(e.current).replace("R$","R$")),3),s("div",ge,"de "+c(k(e.target).replace("R$","R$")),1)]),s("div",_e,[s("div",{class:m(["h-2 rounded-full",e.status==="late"?"bg-orange-500":"bg-[#14B8A6]"]),style:Z({width:`${w(e)}%`})},null,6)]),s("div",ke,c(w(e))+"% concluído",1)])])]),_:2},1032,["href"]))),128))])),g(Y,{open:h.value,kind:I.value,initial:P.value,categories:j.value,accounts:D.value,tags:u.value.tags,onClose:a[0]||(a[0]=e=>h.value=!1),onSave:O},null,8,["open","kind","initial","categories","accounts","tags"])]),_:1},16))],64))}});export{Fe as default};
