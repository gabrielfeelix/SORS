import{d as H,c as n,u as J,h as x,g as c,f as A,a as O,b as N,D as U,w as S,e,l as Z,t as l,k as V,o as r,F as k,r as P,j as z,i as L,n as q,G as Q,H as W,C as X}from"./app-DvJ-vTb0.js";import{u as ee,_ as te}from"./useIsMobile-CMH_TBsk.js";import{_ as se}from"./DesktopShell.vue_vue_type_script_setup_true_lang-BVoVaQ94.js";const ae={class:"flex items-center gap-3 pt-2"},le={class:"mt-6 rounded-2xl bg-white px-3 py-3 shadow-sm ring-1 ring-slate-200/60"},oe={class:"flex items-center justify-between"},ne={class:"text-sm font-semibold text-slate-900"},ie={class:"mt-6 grid grid-cols-2 gap-3"},re={class:"rounded-2xl bg-white p-4 shadow-sm ring-1 ring-slate-200/60"},de={class:"text-[10px] font-semibold uppercase tracking-wide text-slate-400"},ce={class:"mt-3 space-y-2 text-xs font-semibold"},ue={class:"flex items-center justify-between"},me={class:"text-emerald-600"},ve={class:"flex items-center justify-between"},pe={class:"text-red-500"},fe={class:"flex items-center justify-between"},xe={class:"text-emerald-600"},he={class:"rounded-2xl bg-white p-4 shadow-sm ring-1 ring-slate-200/60"},be={class:"text-[10px] font-semibold uppercase tracking-wide text-slate-400"},ge={class:"mt-3 space-y-2 text-xs font-semibold"},we={class:"flex items-center justify-between"},_e={class:"text-emerald-600"},ye={class:"flex items-center justify-between"},ke={class:"text-red-500"},Me={class:"flex items-center justify-between"},$e={class:"text-emerald-600"},Re={class:"mt-5 rounded-3xl bg-amber-50 p-5 shadow-sm ring-1 ring-amber-100"},Ce={class:"flex gap-4"},De={class:"flex-1"},Be={class:"text-sm font-semibold text-slate-900"},je={class:"mt-1 text-sm font-semibold text-amber-700"},Fe={class:"mt-7"},Ae={class:"mt-3 rounded-3xl bg-white p-5 shadow-sm ring-1 ring-slate-200/60"},Ne={class:"text-sm font-semibold text-slate-900"},Se={class:"mt-3 space-y-3"},Ve={class:"flex items-center gap-3"},Pe={class:"h-2 flex-1 rounded-full bg-slate-100"},ze={class:"w-16 text-right text-xs font-semibold text-slate-400"},Le={class:"flex items-center gap-3"},Ie={class:"h-2 flex-1 rounded-full bg-slate-100"},Te={class:"w-16 text-right text-xs font-semibold text-slate-700"},Ke={class:"mt-7 pb-6"},Ye={class:"mt-3 space-y-3"},Ee={class:"flex items-center gap-2"},Ge={key:0,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},He={key:1,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Je={key:2,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Oe={key:0},Ue={key:0,class:"rounded-2xl bg-slate-50 px-4 py-4 text-sm font-semibold text-slate-500 ring-1 ring-slate-100"},Xe=H({__name:"Compare",setup(Ze){const M=ee(),I=n(()=>M.value?te:se),T=n(()=>M.value?{showNav:!1}:{title:"Relatórios",subtitle:"Comparar períodos",showSearch:!1,showNewAction:!1}),K=J(),Y=n(()=>K.props.bootstrap??{entries:[],goals:[],accounts:[],categories:[],tags:[]}),$=n(()=>Y.value.entries??[]),p=x(new Date),R=a=>{const t=new Date(p.value);t.setMonth(t.getMonth()+a),p.value=t},f=a=>`${a.getFullYear()}-${a.getMonth()}`,g=a=>new Intl.DateTimeFormat("pt-BR",{month:"short",year:"numeric"}).format(a).replace(".","").toUpperCase(),w=n(()=>new Date(p.value.getFullYear(),p.value.getMonth(),1)),_=n(()=>new Date(p.value.getFullYear(),p.value.getMonth()-1,1)),E=n(()=>`${g(w.value)} vs ${g(_.value)}`),C=a=>{const t=f(a);let s=0,v=0;for(const i of $.value){if(!i.transactionDate)continue;const o=new Date(i.transactionDate);f(o)==t&&(i.kind==="income"&&(s+=i.amount),i.kind==="expense"&&(v+=i.amount))}return{month:g(a),rec:s,desp:v,total:s-v}},m=n(()=>C(w.value)),u=n(()=>C(_.value)),G=n(()=>u.value.desp?Math.round((m.value.desp-u.value.desp)/u.value.desp*1e3)/10:0),D=n(()=>m.value.desp-u.value.desp),y=n(()=>{const a=new Map,t=new Map,s=f(w.value),v=f(_.value);for(const o of $.value){if(o.kind!=="expense"||!o.transactionDate)continue;const h=new Date(o.transactionDate),F=f(h),b=o.categoryLabel||"Outros";F==s&&a.set(b,(a.get(b)??0)+o.amount),F==v&&t.set(b,(t.get(b)??0)+o.amount)}const i=new Set(a.keys());for(const o of t.keys())i.add(o);return Array.from(i).map(o=>({key:o.toLowerCase().replace(/\s+/g,"-"),label:o,a:a.get(o)??0,b:t.get(o)??0})).sort((o,h)=>h.a+h.b-(o.a+o.b))}),B=n(()=>Math.max(...y.value.flatMap(a=>[a.a,a.b]),1)),j=n(()=>y.value.map(t=>{const s=t.a-t.b,v=t.b>0?Math.round(s/t.b*1e3)/10:t.a>0?100:0,i=s>0?"up":s<0?"down":"flat";return{key:t.key,label:t.label,kind:i,pct:v,abs:s}}).filter(t=>Math.abs(t.abs)>.01||t.pct!==0).sort((t,s)=>Math.abs(s.abs)-Math.abs(t.abs)).slice(0,3)),d=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0}).format(a);return x(!1),x("expense"),x(!1),x(""),(a,t)=>(r(),c(k,null,[A(N(U),{title:"Comparativo"}),(r(),O(X(I.value),Q(W(T.value)),{default:S(()=>[e("header",ae,[A(N(Z),{href:a.route("analysis"),class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white text-slate-600 shadow-sm ring-1 ring-slate-200/60","aria-label":"Voltar"},{default:S(()=>[...t[2]||(t[2]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),_:1},8,["href"]),t[3]||(t[3]=e("div",{class:"text-xl font-semibold tracking-tight text-slate-900"},"Comparativo",-1))]),e("div",le,[e("div",oe,[e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-xl text-slate-500 hover:bg-slate-50","aria-label":"Anterior",onClick:t[0]||(t[0]=s=>R(-1))},[...t[4]||(t[4]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),e("div",ne,l(E.value),1),e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-xl text-slate-500 hover:bg-slate-50","aria-label":"Próximo",onClick:t[1]||(t[1]=s=>R(1))},[...t[5]||(t[5]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)])])])]),e("div",ie,[e("div",re,[e("div",de,l(m.value.month),1),e("div",ce,[e("div",ue,[t[6]||(t[6]=e("div",{class:"text-slate-400"},"Rec.",-1)),e("div",me,l(d(m.value.rec).replace("R$","R$")),1)]),e("div",ve,[t[7]||(t[7]=e("div",{class:"text-slate-400"},"Desp.",-1)),e("div",pe,l(d(m.value.desp).replace("R$","R$")),1)]),e("div",fe,[t[8]||(t[8]=e("div",{class:"text-slate-400"},"Total",-1)),e("div",xe,"+"+l(d(m.value.total).replace("R$","R$")),1)])])]),e("div",he,[e("div",be,l(u.value.month),1),e("div",ge,[e("div",we,[t[9]||(t[9]=e("div",{class:"text-slate-400"},"Rec.",-1)),e("div",_e,l(d(u.value.rec).replace("R$","R$")),1)]),e("div",ye,[t[10]||(t[10]=e("div",{class:"text-slate-400"},"Desp.",-1)),e("div",ke,l(d(u.value.desp).replace("R$","R$")),1)]),e("div",Me,[t[11]||(t[11]=e("div",{class:"text-slate-400"},"Total",-1)),e("div",$e,"+"+l(d(u.value.total).replace("R$","R$")),1)])])])]),e("div",Re,[e("div",Ce,[t[12]||(t[12]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-amber-100 text-amber-600"},[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 9v4"}),e("path",{d:"M12 17h.01"}),e("path",{d:"M10.3 4.2l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.7-2.8l-8-14a2 2 0 0 0-3.4 0Z"})])],-1)),e("div",De,[e("div",Be,"Você gastou "+l(G.value)+"% a mais em "+l(m.value.month),1),e("div",je,l(D.value>=0?"+":"-")+l(d(Math.abs(D.value)).replace("R$","R$"))+" de aumento ",1)])])]),e("div",Fe,[t[13]||(t[13]=e("div",{class:"text-base font-semibold text-slate-900"},"Despesas por categoria",-1)),t[14]||(t[14]=e("div",{class:"mt-3 flex items-center justify-end gap-4 text-xs font-semibold"},[e("span",{class:"inline-flex items-center gap-2 text-slate-400"},[e("span",{class:"h-2 w-2 rounded-full bg-slate-300"}),V(" Dez")]),e("span",{class:"inline-flex items-center gap-2 text-slate-600"},[e("span",{class:"h-2 w-2 rounded-full bg-[#14B8A6]"}),V(" Jan")])],-1)),e("div",Ae,[(r(!0),c(k,null,P(y.value,s=>(r(),c("div",{key:s.key,class:"py-4 first:pt-0 last:pb-0"},[e("div",Ne,l(s.label),1),e("div",Se,[e("div",Ve,[e("div",Pe,[e("div",{class:"h-2 rounded-full bg-slate-300",style:z({width:`${Math.round(s.b/B.value*100)}%`})},null,4)]),e("div",ze,l(d(s.b).replace("R$","R$")),1)]),e("div",Le,[e("div",Ie,[e("div",{class:"h-2 rounded-full bg-[#14B8A6]",style:z({width:`${Math.round(s.a/B.value*100)}%`})},null,4)]),e("div",Te,l(d(s.a).replace("R$","R$")),1)])])]))),128))])]),e("div",Ke,[t[18]||(t[18]=e("div",{class:"text-base font-semibold text-slate-900"},"Insights",-1)),e("div",Ye,[(r(!0),c(k,null,P(j.value,s=>(r(),c("div",{key:s.key,class:q(["flex items-center justify-between rounded-2xl px-4 py-4 text-sm font-semibold ring-1",s.kind==="up"?"bg-red-50 text-red-500 ring-red-100":s.kind==="down"?"bg-emerald-50 text-emerald-600 ring-emerald-100":"bg-slate-50 text-slate-600 ring-slate-100"])},[e("div",Ee,[s.kind==="up"?(r(),c("svg",Ge,[...t[15]||(t[15]=[e("path",{d:"M12 19V5"},null,-1),e("path",{d:"M5 12l7-7 7 7"},null,-1)])])):s.kind==="down"?(r(),c("svg",He,[...t[16]||(t[16]=[e("path",{d:"M12 5v14"},null,-1),e("path",{d:"M19 12l-7 7-7-7"},null,-1)])])):(r(),c("svg",Je,[...t[17]||(t[17]=[e("path",{d:"M5 12h14"},null,-1)])])),e("span",null,l(s.label)+": "+l(s.kind==="flat"?"Sem variação":`${s.abs>0?"+":"-"}${Math.abs(s.pct)}%`),1)]),s.kind!=="flat"?(r(),c("div",Oe,l(s.abs>0?"+":"-")+l(d(Math.abs(s.abs)).replace("R$","R$")),1)):L("",!0)],2))),128)),j.value.length===0?(r(),c("div",Ue," Sem insights suficientes para este período. ")):L("",!0)])])]),_:1},16))],64))}});export{Xe as default};
