import{d as H,c as i,u as J,h as x,g as c,f as S,a as U,b as A,D as Z,w as V,e,l as q,t as o,k as L,o as r,F as k,r as P,j as z,i as I,n as Q,G as W,H as X,C as ee}from"./app-BblmX-k6.js";import{u as te,_ as se}from"./useIsMobile-DqUvSeEk.js";import{_ as ae}from"./DesktopShell.vue_vue_type_script_setup_true_lang-CbAI3--o.js";const le={class:"flex items-center gap-3 pt-2"},oe={class:"mt-6 rounded-2xl bg-white px-3 py-3 shadow-sm ring-1 ring-slate-200/60"},ne={class:"flex items-center justify-between"},ie={class:"text-sm font-semibold text-slate-900"},re={class:"mt-6 grid grid-cols-2 gap-3"},de={class:"rounded-2xl bg-white p-4 shadow-sm ring-1 ring-slate-200/60"},ce={class:"text-[10px] font-semibold uppercase tracking-wide text-slate-400"},ue={class:"mt-3 space-y-2 text-xs font-semibold"},me={class:"flex items-center justify-between"},ve={class:"text-emerald-600"},pe={class:"flex items-center justify-between"},fe={class:"text-red-500"},xe={class:"flex items-center justify-between"},he={class:"text-emerald-600"},be={class:"rounded-2xl bg-white p-4 shadow-sm ring-1 ring-slate-200/60"},ge={class:"text-[10px] font-semibold uppercase tracking-wide text-slate-400"},we={class:"mt-3 space-y-2 text-xs font-semibold"},_e={class:"flex items-center justify-between"},ye={class:"text-emerald-600"},ke={class:"flex items-center justify-between"},Me={class:"text-red-500"},$e={class:"flex items-center justify-between"},Re={class:"text-emerald-600"},De={class:"mt-5 rounded-3xl bg-amber-50 p-5 shadow-sm ring-1 ring-amber-100"},Ce={class:"flex gap-4"},Be={class:"flex-1"},je={class:"text-sm font-semibold text-slate-900"},Ne={class:"mt-1 text-sm font-semibold text-amber-700"},Fe={class:"mt-7"},Se={class:"mt-3 rounded-3xl bg-white p-5 shadow-sm ring-1 ring-slate-200/60"},Ae={class:"text-sm font-semibold text-slate-900"},Ve={class:"mt-3 space-y-3"},Le={class:"flex items-center gap-3"},Pe={class:"h-2 flex-1 rounded-full bg-slate-100"},ze={class:"w-16 text-right text-xs font-semibold text-slate-400"},Ie={class:"flex items-center gap-3"},Te={class:"h-2 flex-1 rounded-full bg-slate-100"},Ke={class:"w-16 text-right text-xs font-semibold text-slate-700"},Ye={class:"mt-7 pb-6"},Oe={class:"mt-3 space-y-3"},Ee={class:"flex items-center gap-2"},Ge={key:0,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},He={key:1,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Je={key:2,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ue={key:0},Ze={key:0,class:"rounded-2xl bg-slate-50 px-4 py-4 text-sm font-semibold text-slate-500 ring-1 ring-slate-100"},et=H({__name:"Compare",setup(qe){const M=te(),T=i(()=>M.value?se:ae),K=i(()=>M.value?{showNav:!1}:{title:"Relatórios",subtitle:"Comparar períodos",showSearch:!1,showNewAction:!1}),Y=J(),O=i(()=>Y.props.bootstrap??{entries:[],goals:[],accounts:[],categories:[],tags:[]}),$=i(()=>O.value.entries??[]),R=a=>{const t=String(a??"").trim().match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!t)return null;const[,s,u,n]=t,l=new Date(Number(s),Number(u)-1,Number(n));return Number.isFinite(l.getTime())?l:null},p=x(new Date),D=a=>{const t=new Date(p.value);t.setMonth(t.getMonth()+a),p.value=t},f=a=>`${a.getFullYear()}-${a.getMonth()}`,g=a=>new Intl.DateTimeFormat("pt-BR",{month:"short",year:"numeric"}).format(a).replace(".","").toUpperCase(),w=i(()=>new Date(p.value.getFullYear(),p.value.getMonth(),1)),_=i(()=>new Date(p.value.getFullYear(),p.value.getMonth()-1,1)),E=i(()=>`${g(w.value)} vs ${g(_.value)}`),C=a=>{const t=f(a);let s=0,u=0;for(const n of $.value){if(!n.transactionDate)continue;const l=R(n.transactionDate)??new Date(n.transactionDate);f(l)==t&&(n.kind==="income"&&(s+=n.amount),n.kind==="expense"&&(u+=n.amount))}return{month:g(a),rec:s,desp:u,total:s-u}},v=i(()=>C(w.value)),m=i(()=>C(_.value)),G=i(()=>m.value.desp?Math.round((v.value.desp-m.value.desp)/m.value.desp*1e3)/10:0),B=i(()=>v.value.desp-m.value.desp),y=i(()=>{const a=new Map,t=new Map,s=f(w.value),u=f(_.value);for(const l of $.value){if(l.kind!=="expense"||!l.transactionDate)continue;const h=R(l.transactionDate)??new Date(l.transactionDate),F=f(h),b=l.categoryLabel||"Outros";F==s&&a.set(b,(a.get(b)??0)+l.amount),F==u&&t.set(b,(t.get(b)??0)+l.amount)}const n=new Set(a.keys());for(const l of t.keys())n.add(l);return Array.from(n).map(l=>({key:l.toLowerCase().replace(/\s+/g,"-"),label:l,a:a.get(l)??0,b:t.get(l)??0})).sort((l,h)=>h.a+h.b-(l.a+l.b))}),j=i(()=>Math.max(...y.value.flatMap(a=>[a.a,a.b]),1)),N=i(()=>y.value.map(t=>{const s=t.a-t.b,u=t.b>0?Math.round(s/t.b*1e3)/10:t.a>0?100:0,n=s>0?"up":s<0?"down":"flat";return{key:t.key,label:t.label,kind:n,pct:u,abs:s}}).filter(t=>Math.abs(t.abs)>.01||t.pct!==0).sort((t,s)=>Math.abs(s.abs)-Math.abs(t.abs)).slice(0,3)),d=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0}).format(a);return x(!1),x("expense"),x(!1),x(""),(a,t)=>(r(),c(k,null,[S(A(Z),{title:"Comparativo"}),(r(),U(ee(T.value),W(X(K.value)),{default:V(()=>[e("header",le,[S(A(q),{href:a.route("analysis"),class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white text-slate-600 shadow-sm ring-1 ring-slate-200/60","aria-label":"Voltar"},{default:V(()=>[...t[2]||(t[2]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),_:1},8,["href"]),t[3]||(t[3]=e("div",{class:"text-xl font-semibold tracking-tight text-slate-900"},"Comparativo",-1))]),e("div",oe,[e("div",ne,[e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-xl text-slate-500 hover:bg-slate-50","aria-label":"Anterior",onClick:t[0]||(t[0]=s=>D(-1))},[...t[4]||(t[4]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),e("div",ie,o(E.value),1),e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-xl text-slate-500 hover:bg-slate-50","aria-label":"Próximo",onClick:t[1]||(t[1]=s=>D(1))},[...t[5]||(t[5]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)])])])]),e("div",re,[e("div",de,[e("div",ce,o(v.value.month),1),e("div",ue,[e("div",me,[t[6]||(t[6]=e("div",{class:"text-slate-400"},"Rec.",-1)),e("div",ve,o(d(v.value.rec).replace("R$","R$")),1)]),e("div",pe,[t[7]||(t[7]=e("div",{class:"text-slate-400"},"Desp.",-1)),e("div",fe,o(d(v.value.desp).replace("R$","R$")),1)]),e("div",xe,[t[8]||(t[8]=e("div",{class:"text-slate-400"},"Total",-1)),e("div",he,"+"+o(d(v.value.total).replace("R$","R$")),1)])])]),e("div",be,[e("div",ge,o(m.value.month),1),e("div",we,[e("div",_e,[t[9]||(t[9]=e("div",{class:"text-slate-400"},"Rec.",-1)),e("div",ye,o(d(m.value.rec).replace("R$","R$")),1)]),e("div",ke,[t[10]||(t[10]=e("div",{class:"text-slate-400"},"Desp.",-1)),e("div",Me,o(d(m.value.desp).replace("R$","R$")),1)]),e("div",$e,[t[11]||(t[11]=e("div",{class:"text-slate-400"},"Total",-1)),e("div",Re,"+"+o(d(m.value.total).replace("R$","R$")),1)])])])]),e("div",De,[e("div",Ce,[t[12]||(t[12]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-amber-100 text-amber-600"},[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 9v4"}),e("path",{d:"M12 17h.01"}),e("path",{d:"M10.3 4.2l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.7-2.8l-8-14a2 2 0 0 0-3.4 0Z"})])],-1)),e("div",Be,[e("div",je,"Você gastou "+o(G.value)+"% a mais em "+o(v.value.month),1),e("div",Ne,o(B.value>=0?"+":"-")+o(d(Math.abs(B.value)).replace("R$","R$"))+" de aumento ",1)])])]),e("div",Fe,[t[13]||(t[13]=e("div",{class:"text-base font-semibold text-slate-900"},"Despesas por categoria",-1)),t[14]||(t[14]=e("div",{class:"mt-3 flex items-center justify-end gap-4 text-xs font-semibold"},[e("span",{class:"inline-flex items-center gap-2 text-slate-400"},[e("span",{class:"h-2 w-2 rounded-full bg-slate-300"}),L(" Dez")]),e("span",{class:"inline-flex items-center gap-2 text-slate-600"},[e("span",{class:"h-2 w-2 rounded-full bg-[#14B8A6]"}),L(" Jan")])],-1)),e("div",Se,[(r(!0),c(k,null,P(y.value,s=>(r(),c("div",{key:s.key,class:"py-4 first:pt-0 last:pb-0"},[e("div",Ae,o(s.label),1),e("div",Ve,[e("div",Le,[e("div",Pe,[e("div",{class:"h-2 rounded-full bg-slate-300",style:z({width:`${Math.round(s.b/j.value*100)}%`})},null,4)]),e("div",ze,o(d(s.b).replace("R$","R$")),1)]),e("div",Ie,[e("div",Te,[e("div",{class:"h-2 rounded-full bg-[#14B8A6]",style:z({width:`${Math.round(s.a/j.value*100)}%`})},null,4)]),e("div",Ke,o(d(s.a).replace("R$","R$")),1)])])]))),128))])]),e("div",Ye,[t[18]||(t[18]=e("div",{class:"text-base font-semibold text-slate-900"},"Insights",-1)),e("div",Oe,[(r(!0),c(k,null,P(N.value,s=>(r(),c("div",{key:s.key,class:Q(["flex items-center justify-between rounded-2xl px-4 py-4 text-sm font-semibold ring-1",s.kind==="up"?"bg-red-50 text-red-500 ring-red-100":s.kind==="down"?"bg-emerald-50 text-emerald-600 ring-emerald-100":"bg-slate-50 text-slate-600 ring-slate-100"])},[e("div",Ee,[s.kind==="up"?(r(),c("svg",Ge,[...t[15]||(t[15]=[e("path",{d:"M12 19V5"},null,-1),e("path",{d:"M5 12l7-7 7 7"},null,-1)])])):s.kind==="down"?(r(),c("svg",He,[...t[16]||(t[16]=[e("path",{d:"M12 5v14"},null,-1),e("path",{d:"M19 12l-7 7-7-7"},null,-1)])])):(r(),c("svg",Je,[...t[17]||(t[17]=[e("path",{d:"M5 12h14"},null,-1)])])),e("span",null,o(s.label)+": "+o(s.kind==="flat"?"Sem variação":`${s.abs>0?"+":"-"}${Math.abs(s.pct)}%`),1)]),s.kind!=="flat"?(r(),c("div",Ue,o(s.abs>0?"+":"-")+o(d(Math.abs(s.abs)).replace("R$","R$")),1)):I("",!0)],2))),128)),N.value.length===0?(r(),c("div",Ze," Sem insights suficientes para este período. ")):I("",!0)])])]),_:1},16))],64))}});export{et as default};
