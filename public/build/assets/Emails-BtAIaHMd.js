import{d as L,c as p,h as x,J as _,g as d,f as k,a as G,b as n,D as H,w as F,e,n as C,k as V,t as a,o as i,F as B,r as J,i as E,G as O,H as W,C as Q,x as b,I as g,K as X,m as y}from"./app-Pd0ejbZJ.js";import{u as Y,_ as Z}from"./useIsMobile-CRomRP0o.js";import{_ as ee}from"./DesktopShell.vue_vue_type_script_setup_true_lang-CaKEcI4E.js";import{_ as te}from"./AdminHeader.vue_vue_type_script_setup_true_lang-BMtTlgrr.js";import{_ as se}from"./Modal.vue_vue_type_script_setup_true_lang-DjEikzG1.js";const le={class:"space-y-4"},oe={class:"rounded-3xl bg-white p-6 shadow-sm ring-1 ring-slate-200/60"},ne={class:"flex flex-wrap items-start justify-between gap-4"},ae={class:"flex flex-wrap items-center gap-2"},ie={class:"ml-2 rounded-full bg-white/60 px-2 py-0.5 text-xs font-bold text-slate-600 ring-1 ring-slate-200/60"},de={class:"ml-2 rounded-full bg-white/60 px-2 py-0.5 text-xs font-bold text-slate-600 ring-1 ring-slate-200/60"},re={class:"mt-5 flex flex-wrap items-center justify-between gap-3"},ue={class:"text-xs font-semibold text-slate-400"},me={key:0,class:"mt-6 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-10 text-center"},ce={key:1,class:"mt-6 space-y-3"},pe={class:"flex flex-wrap items-start justify-between gap-3"},xe={class:"min-w-0"},be={class:"flex flex-wrap items-center gap-2"},ve={class:"truncate text-base font-semibold text-slate-900"},fe={class:"mt-1 text-xs font-semibold text-slate-500"},ge={key:0},ye={key:1},we={key:2},he={class:"flex flex-wrap items-center gap-2"},_e=["onClick"],ke=["disabled","onClick"],Ce=["onClick"],Ee={key:0,class:"mt-3 rounded-xl bg-red-50 p-3 ring-1 ring-red-100"},je={class:"mt-2 flex justify-end gap-2"},Ne=["disabled","onClick"],Se={class:"p-6"},$e={class:"flex items-start justify-between gap-4"},Ae={class:"text-lg font-semibold text-slate-900"},Fe={class:"mt-5 grid gap-4 md:grid-cols-2"},Ve={class:"block md:col-span-2"},Be={class:"block md:col-span-2"},Te={class:"block"},De={class:"block"},Me={class:"block md:col-span-2"},Ue={key:0,class:"mt-4 rounded-2xl bg-red-50 p-4 text-sm font-semibold text-red-700"},ze={class:"mt-6 flex items-center justify-end gap-2"},Ie=["disabled"],Ge=L({__name:"Emails",props:{campaigns:{}},setup(T){const w=T,j=Y(),D=p(()=>j.value?Z:ee),M=p(()=>j.value?{showNav:!1}:{title:"Administração",showSearch:!1,showNewAction:!1}),r=x("announcement"),N=p(()=>w.campaigns.filter(s=>(s.type==="newsletter"?"newsletter":"announcement")===r.value)),U=p(()=>w.campaigns.filter(s=>s.type!=="newsletter").length),z=p(()=>w.campaigns.filter(s=>s.type==="newsletter").length),h=s=>{if(!s)return"";const t=new Date(s);return Number.isFinite(t.getTime())?t.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):String(s)},S=s=>s==="sent"?{label:"Enviado",cls:"bg-emerald-50 text-emerald-700"}:s==="scheduled"?{label:"Agendado",cls:"bg-amber-50 text-amber-700"}:s==="failed"?{label:"Falhou",cls:"bg-red-50 text-red-700"}:{label:"Rascunho",cls:"bg-slate-100 text-slate-700"},u=x(!1),m=x(null),o=_({type:"announcement",title:"",subject:"",content:"",status:"draft",scheduled_at:""}),I=s=>{m.value=null,o.reset(),o.clearErrors(),o.type=s,u.value=!0},q=s=>{m.value=s.id,o.reset(),o.clearErrors(),o.type=s.type==="newsletter"?"newsletter":"announcement",o.title=s.title,o.subject=s.subject??"",o.content=s.content??"",o.status=s.status==="scheduled"?"scheduled":"draft",o.scheduled_at=s.scheduled_at?s.scheduled_at.slice(0,16):"",u.value=!0},R=()=>{if(o.transform(s=>({type:s.type,title:s.title,subject:s.subject||null,content:s.content||null,status:s.status,scheduled_at:s.scheduled_at||null})),m.value){o.patch(route("admin.emails.update",m.value),{preserveScroll:!0,onSuccess:()=>{u.value=!1,y.reload({only:["campaigns"]})}});return}o.post(route("admin.emails.store"),{preserveScroll:!0,onSuccess:()=>{u.value=!1,y.reload({only:["campaigns"]})}})},c=x(null),$=_({}),K=s=>{$.delete(route("admin.emails.destroy",s),{preserveScroll:!0,onSuccess:()=>{c.value=null,y.reload({only:["campaigns"]})}})},A=_({}),v=x(null),P=s=>{v.value=s,A.post(route("admin.emails.send",s),{preserveScroll:!0,onFinish:()=>{v.value=null,y.reload({only:["campaigns"]})}})};return(s,t)=>(i(),d(B,null,[k(n(H),{title:"Administração · E-mails e Comunicados"}),(i(),G(Q(D.value),O(W(M.value)),{default:F(()=>[e("div",le,[k(te,{description:"Crie comunicados (todos os usuários) e newsletters (leads da landing page)."}),e("div",oe,[e("div",ne,[t[14]||(t[14]=e("div",null,[e("div",{class:"text-sm font-semibold text-slate-900"},"Comunicados e Newsletter"),e("div",{class:"mt-1 text-xs font-semibold text-slate-400"},"Envios editoriais e anúncios do Kitamo")],-1)),e("div",ae,[e("button",{type:"button",class:C(["inline-flex items-center justify-center rounded-2xl px-4 py-2 text-sm font-semibold ring-1 transition",r.value==="announcement"?"bg-emerald-50 text-emerald-700 ring-emerald-100":"bg-white text-slate-600 ring-slate-200 hover:bg-slate-50"]),onClick:t[0]||(t[0]=l=>r.value="announcement")},[t[12]||(t[12]=V(" Comunicados ",-1)),e("span",ie,a(U.value),1)],2),e("button",{type:"button",class:C(["inline-flex items-center justify-center rounded-2xl px-4 py-2 text-sm font-semibold ring-1 transition",r.value==="newsletter"?"bg-emerald-50 text-emerald-700 ring-emerald-100":"bg-white text-slate-600 ring-slate-200 hover:bg-slate-50"]),onClick:t[1]||(t[1]=l=>r.value="newsletter")},[t[13]||(t[13]=V(" Newsletter ",-1)),e("span",de,a(z.value),1)],2)])]),e("div",re,[e("button",{type:"button",class:"inline-flex items-center justify-center rounded-2xl bg-[#14B8A6] px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20",onClick:t[2]||(t[2]=l=>I(r.value))}," + "+a(r.value==="newsletter"?"Nova newsletter":"Novo comunicado"),1),e("div",ue,a(r.value==="newsletter"?"Newsletter vai para leads inscritos.":"Comunicados vão para todos os usuários ativos."),1)]),N.value.length===0?(i(),d("div",me,[...t[15]||(t[15]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Nenhum item ainda",-1),e("div",{class:"mt-2 text-xs font-semibold text-slate-500"},"Crie seu primeiro envio para aparecer aqui.",-1)])])):(i(),d("div",ce,[(i(!0),d(B,null,J(N.value,l=>(i(),d("div",{key:l.id,class:"rounded-2xl bg-slate-50 p-4 ring-1 ring-slate-200/60"},[e("div",pe,[e("div",xe,[e("div",be,[e("div",ve,a(l.title),1),e("span",{class:C(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",S(l.status).cls])},a(S(l.status).label),3)]),e("div",fe,[l.sent_at?(i(),d("span",ge,"Enviado em "+a(h(l.sent_at))+" • "+a(l.sent_count)+" envios",1)):l.scheduled_at?(i(),d("span",ye,"Agendado para "+a(h(l.scheduled_at)),1)):(i(),d("span",we,"Criado em "+a(h(l.created_at)),1))])]),e("div",he,[e("button",{type:"button",class:"rounded-xl bg-white px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200/60 hover:bg-slate-50",onClick:f=>q(l)}," Editar ",8,_e),l.status!=="sent"?(i(),d("button",{key:0,type:"button",class:"rounded-xl bg-emerald-600 px-3 py-2 text-xs font-semibold text-white shadow-lg shadow-emerald-500/20 disabled:opacity-60",disabled:n(A).processing&&v.value===l.id,onClick:f=>P(l.id)},a(v.value===l.id?"Enviando…":"Enviar agora"),9,ke)):E("",!0),e("button",{type:"button",class:"rounded-xl bg-red-50 px-3 py-2 text-xs font-semibold text-red-700 ring-1 ring-red-100 hover:bg-red-100",onClick:f=>c.value=c.value===l.id?null:l.id}," Excluir ",8,Ce)])]),c.value===l.id?(i(),d("div",Ee,[t[16]||(t[16]=e("div",{class:"text-xs font-semibold text-red-700"},"Tem certeza que deseja excluir?",-1)),e("div",je,[e("button",{type:"button",class:"px-3 py-2 text-xs font-semibold text-slate-600",onClick:t[3]||(t[3]=f=>c.value=null)},"Cancelar"),e("button",{type:"button",class:"rounded-xl bg-red-600 px-3 py-2 text-xs font-semibold text-white disabled:opacity-60",disabled:n($).processing,onClick:f=>K(l.id)}," Excluir agora ",8,Ne)])])):E("",!0)]))),128))]))])])]),_:1},16)),k(se,{show:u.value,maxWidth:"2xl",onClose:t[11]||(t[11]=l=>u.value=!1)},{default:F(()=>[e("div",Se,[e("div",$e,[e("div",null,[e("div",Ae,a(m.value?"Editar":"Novo")+" "+a(n(o).type==="newsletter"?"newsletter":"comunicado"),1),t[17]||(t[17]=e("div",{class:"mt-1 text-sm text-slate-500"},"Use nossa identidade visual e um texto direto.",-1))]),e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-50 text-slate-600 ring-1 ring-slate-200/60","aria-label":"Fechar",onClick:t[4]||(t[4]=l=>u.value=!1)},[...t[18]||(t[18]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M6 6l12 12"}),e("path",{d:"M18 6l-12 12"})],-1)])])]),e("div",Fe,[e("label",Ve,[t[19]||(t[19]=e("div",{class:"text-xs font-semibold text-slate-500"},"Título *",-1)),b(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>n(o).title=l),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800 placeholder:text-slate-400",placeholder:"Ex.: Novidades da semana"},null,512),[[g,n(o).title]])]),e("label",Be,[t[20]||(t[20]=e("div",{class:"text-xs font-semibold text-slate-500"},"Assunto (opcional)",-1)),b(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>n(o).subject=l),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800 placeholder:text-slate-400",placeholder:"Ex.: Atualizações do Kitamo"},null,512),[[g,n(o).subject]])]),e("label",Te,[t[22]||(t[22]=e("div",{class:"text-xs font-semibold text-slate-500"},"Status",-1)),b(e("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>n(o).status=l),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...t[21]||(t[21]=[e("option",{value:"draft"},"Rascunho",-1),e("option",{value:"scheduled"},"Agendado",-1)])],512),[[X,n(o).status]])]),e("label",De,[t[23]||(t[23]=e("div",{class:"text-xs font-semibold text-slate-500"},"Agendar para (opcional)",-1)),b(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>n(o).scheduled_at=l),type:"datetime-local",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800"},null,512),[[g,n(o).scheduled_at]])]),e("label",Me,[t[24]||(t[24]=e("div",{class:"text-xs font-semibold text-slate-500"},"Conteúdo",-1)),b(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=l=>n(o).content=l),rows:"8",class:"mt-2 w-full resize-none appearance-none rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-800 placeholder:text-slate-400",placeholder:"Escreva aqui..."},null,512),[[g,n(o).content]])])]),n(o).hasErrors?(i(),d("div",Ue," Não foi possível salvar. Verifique os campos. ")):E("",!0),e("div",ze,[e("button",{type:"button",class:"rounded-xl px-4 py-2 text-sm font-semibold text-slate-600",onClick:t[10]||(t[10]=l=>u.value=!1)},"Cancelar"),e("button",{type:"button",class:"rounded-xl bg-[#14B8A6] px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20 disabled:opacity-60",disabled:n(o).processing,onClick:R},a(n(o).processing?"Salvando…":"Salvar"),9,Ie)])])]),_:1},8,["show"])],64))}});export{Ge as default};
