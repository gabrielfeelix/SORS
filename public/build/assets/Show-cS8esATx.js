import{d as de,h as c,c as v,p as ce,g as u,F as E,i as L,f as y,e,j as te,t as m,x as oe,I as ie,b as T,n as $,r as O,w as q,o as r,s as ye,u as je,a as ke,D as Ne,l as ae,A as Fe,k as X,m as ne}from"./app-DvJ-vTb0.js";import{a as Ie,u as Ve,_ as Te}from"./useIsMobile-CMH_TBsk.js";import{_ as Le,r as ee}from"./DesktopShell.vue_vue_type_script_setup_true_lang-BVoVaQ94.js";import{_ as _e}from"./MobileToast.vue_vue_type_script_setup_true_lang-C8uRLjf5.js";import{_ as $e}from"./ConfirmationModal.vue_vue_type_script_setup_true_lang-DOl0UncE.js";import{m as re,n as Oe,p as Ce,f as ue}from"./inputGuards-BTKUKM9N.js";import{_ as ze}from"./MonthNavigator.vue_vue_type_script_setup_true_lang-BF8bI4Ys.js";const Re={key:0,class:"fixed inset-0 z-[90] bg-white"},Ye={class:"mx-auto w-full max-w-md px-5 pb-[calc(6rem+env(safe-area-inset-bottom))]"},Pe={class:"flex justify-center pt-2"},Ue={key:0,class:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ze={key:1,class:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},qe={key:2,class:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},He={class:"mt-6 space-y-5"},Je={class:"truncate"},We=["value"],Ke={class:"grid grid-cols-3 gap-3"},Ge={class:"flex gap-3"},Qe=["onClick","aria-label"],Xe={class:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-4"},et={class:"flex items-center justify-between"},tt={class:"grid grid-cols-3 gap-4"},lt=["onClick","aria-label"],st={key:0,class:"h-6 w-6 text-slate-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},at={key:1,class:"h-6 w-6 text-slate-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},nt={key:2,class:"h-6 w-6 text-slate-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ot={class:"fixed inset-x-0 bottom-0 bg-white px-5 pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 shadow-[0_-18px_40px_-32px_rgba(15,23,42,0.45)]"},it={class:"mx-auto w-full max-w-md"},rt=["disabled"],ut={class:"space-y-4"},dt={class:"grid grid-cols-2 gap-3"},ct=["onClick"],vt={class:"min-w-0 flex-1"},mt={class:"truncate text-sm font-semibold text-slate-900"},Me=de({__name:"NewAccountModal",props:{open:{type:Boolean},initial:{}},emits:["close","save"],setup(j,{emit:z}){const x=j,N=z,C=[{nome:"Nubank",logo:"üü£",cor:"#8B10AE"},{nome:"Banco Inter",logo:"üü¢",cor:"#FF7A00"},{nome:"Ita√∫",logo:"üü†",cor:"#EC7000"},{nome:"Bradesco",logo:"üî¥",cor:"#CC092F"},{nome:"Banco do Brasil",logo:"üü°",cor:"#FFDD00"},{nome:"Caixa",logo:"üîµ",cor:"#0066B3"},{nome:"Santander",logo:"üî¥",cor:"#EC0000"},{nome:"C6 Bank",logo:"‚ö´",cor:"#000000"},{nome:"PicPay",logo:"üü¢",cor:"#21C25E"},{nome:"Neon",logo:"üîµ",cor:"#00D9E1"},{nome:"Outro",logo:"‚ö™",cor:"#64748B"}],n=["#14B8A6","#10B981","#3B82F6","#8B5CF6","#F59E0B","#EF4444"],h=["bank","phone","home"],b=c(!1),M=c(""),k=c(null),S=c(""),A=c(""),f=c("corrente"),_=c("#14B8A6"),g=c(!0),o=c("bank"),p=v(()=>{const w=M.value.trim().toLowerCase();return w?C.filter(s=>s.nome.toLowerCase().includes(w)):C}),R=v(()=>k.value||"Selecione"),H=w=>{const s=w??"",a=s.split(" - ").map(D=>D.trim()).filter(Boolean);return a.length>=2?{institution:a[0]??null,nickname:a.slice(1).join(" - ")}:{institution:null,nickname:s.trim()}},G=w=>{const s=w.target;A.value=ue(s.value)},J=v(()=>re(A.value)),Y=()=>N("close"),P=()=>{if(!x.initial?.id)return;const w=k.value&&k.value!=="Outro"?k.value:null,s=S.value.trim(),a=w?`${w}${s?` - ${s}`:""}`.trim():s;a&&N("save",{id:x.initial.id,name:a,icon:o.value,current_balance:J.value,color:_.value,incluir_soma:g.value,institution:w,bank_account_type:f.value})};return ce(()=>x.open,w=>{if(!w)return;const s=x.initial??null;if(M.value="",!s)return;const a=H(s.name);k.value=s.institution??a.institution??"Outro",S.value=a.nickname,A.value=Oe(Number(s.current_balance??0)),_.value=s.color??"#14B8A6",g.value=s.incluir_soma??!0;const D=String(s.bank_account_type??"corrente");f.value=D==="poupanca"?"poupanca":D==="salario"?"salario":"corrente";const Q=String(s.icon??"bank");o.value=h.includes(Q)?Q:"bank"}),(w,s)=>(r(),u(E,null,[j.open?(r(),u("div",Re,[e("header",{class:"flex items-center gap-3 px-5 pb-4 pt-[calc(1rem+env(safe-area-inset-top))]"},[e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100 text-slate-600","aria-label":"Voltar",onClick:Y},[...s[9]||(s[9]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),s[10]||(s[10]=e("div",{class:"text-xl font-semibold tracking-tight text-slate-900"},"Editar conta",-1))]),e("main",Ye,[e("div",Pe,[e("div",{class:"flex h-16 w-16 items-center justify-center rounded-3xl text-white shadow-lg shadow-black/10",style:te({backgroundColor:_.value})},[o.value==="bank"?(r(),u("svg",Ue,[...s[11]||(s[11]=[e("path",{d:"M3 10h18"},null,-1),e("path",{d:"M5 10V8l7-5 7 5v2"},null,-1),e("path",{d:"M6 10v9"},null,-1),e("path",{d:"M18 10v9"},null,-1)])])):o.value==="phone"?(r(),u("svg",Ze,[...s[12]||(s[12]=[e("rect",{x:"7",y:"2",width:"10",height:"20",rx:"2"},null,-1),e("path",{d:"M11 19h2"},null,-1)])])):(r(),u("svg",qe,[...s[13]||(s[13]=[e("path",{d:"M3 10h18"},null,-1),e("path",{d:"M5 10V8l7-5 7 5v2"},null,-1),e("path",{d:"M6 10v9"},null,-1),e("path",{d:"M18 10v9"},null,-1)])]))],4)]),e("div",He,[e("div",null,[s[15]||(s[15]=e("div",{class:"mb-2 text-sm font-semibold text-slate-700"},"Institui√ß√£o financeira",-1)),e("button",{type:"button",class:"flex w-full items-center justify-between rounded-2xl border border-slate-200 bg-slate-50 px-4 py-4 text-left text-sm font-semibold text-slate-700",onClick:s[0]||(s[0]=a=>b.value=!0)},[e("span",Je,m(R.value),1),s[14]||(s[14]=e("svg",{class:"h-5 w-5 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1))])]),e("div",null,[s[16]||(s[16]=e("div",{class:"mb-2 text-sm font-semibold text-slate-700"},"Nome da conta",-1)),oe(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>S.value=a),type:"text",placeholder:"Ex: Conta pessoal",class:"w-full appearance-none rounded-2xl border border-slate-200 bg-slate-50 px-4 py-4 text-sm font-semibold text-slate-700 placeholder:text-slate-400 focus:border-teal-400 focus:outline-none focus:ring-0 focus-visible:outline-none"},null,512),[[ie,S.value]])]),e("div",null,[s[17]||(s[17]=e("div",{class:"mb-2 text-sm font-semibold text-slate-700"},"Saldo atual",-1)),e("input",{value:A.value,type:"text",inputmode:"numeric",pattern:"[0-9]*",placeholder:"0,00",class:"w-full appearance-none rounded-2xl border border-slate-200 bg-slate-50 px-4 py-4 text-sm font-semibold text-slate-700 focus:border-teal-400 focus:outline-none focus:ring-0 focus-visible:outline-none",onInput:G,onKeydown:s[2]||(s[2]=(...a)=>T(Ce)&&T(Ce)(...a)),"aria-label":"Saldo atual"},null,40,We)]),e("div",null,[s[18]||(s[18]=e("div",{class:"mb-2 text-sm font-semibold text-slate-700"},"Tipo de conta",-1)),e("div",Ke,[e("button",{type:"button",class:$(["rounded-2xl px-4 py-3 text-sm font-semibold",f.value==="corrente"?"bg-teal-500 text-white":"bg-white text-slate-500 ring-1 ring-slate-200"]),onClick:s[3]||(s[3]=a=>f.value="corrente")}," Corrente ",2),e("button",{type:"button",class:$(["rounded-2xl px-4 py-3 text-sm font-semibold",f.value==="poupanca"?"bg-teal-500 text-white":"bg-white text-slate-500 ring-1 ring-slate-200"]),onClick:s[4]||(s[4]=a=>f.value="poupanca")}," Poupan√ßa ",2),e("button",{type:"button",class:$(["rounded-2xl px-4 py-3 text-sm font-semibold",f.value==="salario"?"bg-teal-500 text-white":"bg-white text-slate-500 ring-1 ring-slate-200"]),onClick:s[5]||(s[5]=a=>f.value="salario")}," Sal√°rio ",2)])]),e("div",null,[s[19]||(s[19]=e("div",{class:"mb-2 text-sm font-semibold text-slate-700"},"Cor da conta",-1)),e("div",Ge,[(r(),u(E,null,O(n,a=>e("button",{key:a,type:"button",class:$(["h-12 w-12 rounded-2xl border-2 transition",_.value===a?"border-slate-900 ring-2 ring-white ring-offset-2 ring-offset-slate-900":"border-transparent hover:border-slate-200"]),style:te({backgroundColor:a}),onClick:D=>_.value=a,"aria-label":`Cor ${a}`},null,14,Qe)),64))])]),e("div",Xe,[e("div",et,[s[20]||(s[20]=e("div",{class:"text-sm font-semibold text-slate-700"},"Incluir na soma da tela inicial",-1)),e("button",{type:"button",class:$(["relative inline-flex h-6 w-11 items-center rounded-full transition",g.value?"bg-teal-500":"bg-slate-300"]),onClick:s[6]||(s[6]=a=>g.value=!g.value),"aria-label":"Incluir na soma"},[e("span",{class:$(["inline-block h-5 w-5 transform rounded-full bg-white transition",g.value?"translate-x-5":"translate-x-0.5"])},null,2)],2)])]),e("div",null,[s[24]||(s[24]=e("div",{class:"mb-2 text-sm font-semibold text-slate-700"},"√çcone",-1)),e("div",tt,[(r(),u(E,null,O(h,a=>e("button",{key:a,type:"button",class:$(["flex h-14 w-full items-center justify-center rounded-2xl bg-slate-50 ring-1 ring-slate-200",o.value===a?"ring-2 ring-teal-400":""]),onClick:D=>o.value=a,"aria-label":`√çcone ${a}`},[a==="bank"?(r(),u("svg",st,[...s[21]||(s[21]=[e("path",{d:"M3 10h18"},null,-1),e("path",{d:"M5 10V8l7-5 7 5v2"},null,-1),e("path",{d:"M6 10v9"},null,-1),e("path",{d:"M18 10v9"},null,-1)])])):a==="phone"?(r(),u("svg",at,[...s[22]||(s[22]=[e("rect",{x:"7",y:"2",width:"10",height:"20",rx:"2"},null,-1),e("path",{d:"M11 19h2"},null,-1)])])):(r(),u("svg",nt,[...s[23]||(s[23]=[e("path",{d:"M4 19V5"},null,-1),e("path",{d:"M10 19V9"},null,-1),e("path",{d:"M16 19v-4"},null,-1),e("path",{d:"M22 19V7"},null,-1)])]))],10,lt)),64))])])])]),e("footer",ot,[e("div",it,[e("button",{type:"button",class:"w-full rounded-2xl bg-teal-500 py-4 text-base font-semibold text-white shadow-lg shadow-teal-500/25 disabled:opacity-60",disabled:!S.value.trim(),onClick:P}," Salvar altera√ß√µes ",8,rt)])])])):L("",!0),y(Ie,{open:b.value,title:"Institui√ß√£o financeira",onClose:s[8]||(s[8]=a=>b.value=!1)},{default:q(()=>[e("div",ut,[oe(e("input",{"onUpdate:modelValue":s[7]||(s[7]=a=>M.value=a),type:"text",placeholder:"Buscar por nome",class:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-semibold text-slate-700 placeholder:text-slate-400 focus:border-teal-400 focus:outline-none focus:ring-0"},null,512),[[ie,M.value]]),e("div",dt,[(r(!0),u(E,null,O(p.value,a=>(r(),u("button",{key:a.nome,type:"button",class:"flex items-center gap-3 rounded-2xl bg-slate-50 px-4 py-4 text-left ring-1 ring-slate-200/70",onClick:()=>{k.value=a.nome,b.value=!1}},[e("span",{class:"flex h-10 w-10 items-center justify-center rounded-2xl text-lg",style:te({backgroundColor:`${a.cor}22`,color:a.cor})},m(a.logo),5),e("div",vt,[e("div",mt,m(a.nome),1)])],8,ct))),128))])])]),_:1},8,["open"])],64))}}),pt={key:0,class:"fixed inset-0 z-[90] bg-white flex flex-col"},bt={class:"border-b border-slate-200/70 px-5 pt-[calc(1rem+env(safe-area-inset-top))] pb-4 flex items-center gap-4"},xt={class:"flex-1 overflow-y-auto px-5 py-6 max-w-md mx-auto w-full"},ft={class:"mb-6"},gt={class:"mb-6"},wt=["value"],ht={key:0,class:"mt-3 rounded-lg border-l-4 border-amber-400 bg-amber-50 p-4"},yt={class:"mb-8"},kt={class:"flex gap-3"},_t=["onClick","aria-label"],$t={class:"rounded-xl border border-slate-200 bg-slate-50 p-4 mb-4"},Ct={class:"flex items-center justify-between"},Mt=["aria-label"],Be=de({__name:"WalletEditModal",props:{open:{type:Boolean},wallet:{}},emits:["close","save"],setup(j,{emit:z}){const x=j,N=z,C=c(""),n=c(""),h=c("#14B8A6"),b=c(!0),M=c(0),k=["#14B8A6","#10B981","#3B82F6","#8B5CF6","#F59E0B","#EF4444"],S=v(()=>re(n.value)!==M.value),A=v(()=>re(n.value)),f=g=>{const o=g.target;n.value=ue(o.value)},_=()=>{if(!x.wallet)return;const g={id:x.wallet.id,name:C.value.trim(),initial_balance:A.value,color:h.value};x.wallet.incluir_soma!==void 0&&(g.incluir_soma=b.value),N("save",g)};return ce(()=>x.open,g=>{if(!g||!x.wallet)return;C.value=x.wallet.name;const o=x.wallet.initial_balance??x.wallet.current_balance;M.value=o,n.value=ue(String(o*100)),h.value=x.wallet.color??"#14B8A6",b.value=x.wallet.incluir_soma??!0}),(g,o)=>j.open?(r(),u("div",pt,[e("header",bt,[e("button",{type:"button",class:"text-slate-600 hover:text-slate-900 transition",onClick:o[0]||(o[0]=p=>N("close"))},[...o[3]||(o[3]=[e("svg",{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1)])]),o[4]||(o[4]=e("h1",{class:"text-lg font-semibold text-slate-900"},"Editar Carteira",-1))]),e("main",xt,[o[10]||(o[10]=ye('<div class="flex justify-center mb-8"><div class="flex h-20 w-20 items-center justify-center rounded-3xl bg-teal-50"><svg class="h-10 w-10 text-teal-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path><path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path><path d="M18 12a2 2 0 0 0 0 4h4v-4Z"></path></svg></div></div>',1)),e("div",ft,[o[5]||(o[5]=e("label",{class:"block text-sm font-semibold text-slate-900 mb-2"},"Nome da carteira",-1)),oe(e("input",{"onUpdate:modelValue":o[1]||(o[1]=p=>C.value=p),type:"text",placeholder:"Ex: Carteira Principal",class:"w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-slate-900 placeholder-slate-400 transition focus:border-emerald-500 focus:outline-none"},null,512),[[ie,C.value]])]),e("div",gt,[o[7]||(o[7]=e("label",{class:"block text-sm font-semibold text-slate-900 mb-2"},"Saldo inicial",-1)),e("input",{value:n.value,type:"text",inputmode:"decimal",placeholder:"R$ 0,00",class:"w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-slate-900 placeholder-slate-400 transition focus:border-emerald-500 focus:outline-none",onInput:f},null,40,wt),S.value?(r(),u("div",ht,[...o[6]||(o[6]=[ye('<div class="flex gap-2"><span class="flex-shrink-0 text-amber-600">‚ö†Ô∏è</span><div class="flex-1"><p class="text-sm font-semibold text-amber-900">Aten√ß√£o!</p><p class="mt-1 text-sm text-amber-800">Alterar o saldo inicial pode impactar a concilia√ß√£o de contas. Recomendamos criar uma transa√ß√£o de ajuste ao inv√©s de alterar diretamente.</p></div></div>',1)])])):L("",!0)]),e("div",yt,[o[8]||(o[8]=e("label",{class:"block text-sm font-semibold text-slate-900 mb-3"},"Cor da carteira",-1)),e("div",kt,[(r(),u(E,null,O(k,p=>e("button",{key:p,type:"button",style:te({backgroundColor:p}),class:$(["h-12 w-12 rounded-2xl border-2 transition",h.value===p?"border-slate-900 ring-2 ring-white ring-offset-2 ring-offset-slate-900":"border-transparent hover:border-slate-200"]),onClick:R=>h.value=p,"aria-label":`Select color ${p}`},null,14,_t)),64))])]),e("div",$t,[e("div",Ct,[o[9]||(o[9]=e("label",{class:"text-sm font-semibold text-slate-900"},"Incluir na soma da tela inicial",-1)),e("button",{type:"button",class:$(["relative inline-flex h-6 w-11 items-center rounded-full transition",b.value?"bg-emerald-500":"bg-slate-300"]),onClick:o[2]||(o[2]=p=>b.value=!b.value),"aria-label":b.value?"Ativado":"Desativado"},[e("span",{class:$(["inline-block h-5 w-5 transform rounded-full bg-white transition",b.value?"translate-x-5":"translate-x-0.5"])},null,2)],10,Mt)])])]),e("footer",{class:"border-t border-slate-200/70 bg-white px-5 py-4 max-w-md mx-auto w-full"},[e("button",{type:"button",onClick:_,class:"w-full rounded-xl bg-emerald-500 py-3 font-semibold text-white transition hover:bg-emerald-600 active:bg-emerald-700"}," Salvar altera√ß√µes ")])])):L("",!0)}}),Bt={class:"flex items-center justify-between pt-2"},St={class:"text-center"},Dt={key:0,class:"text-[11px] font-bold uppercase tracking-wide text-slate-400"},Et={key:1,class:"text-[11px] font-bold uppercase tracking-wide text-slate-400"},At={class:"text-lg font-semibold text-slate-900"},jt={class:"relative"},Nt={class:"mt-6"},Ft={key:0,class:"mt-6 rounded-lg border-l-4 border-amber-500 bg-amber-50 p-3"},It={class:"mt-6 rounded-3xl bg-white p-5 shadow-sm ring-1 ring-slate-200/60"},Vt={class:"text-[11px] font-bold uppercase tracking-wide text-slate-400"},Tt={key:0,class:"mt-2 h-9 w-48 animate-pulse rounded-lg bg-slate-200"},Lt={key:1,class:"mt-2 text-3xl font-bold tracking-tight text-slate-900"},Ot={key:2,class:"mt-2 text-xs text-slate-400"},zt={key:3,class:"mt-5 grid grid-cols-2 gap-3"},Rt={key:4,class:"mt-5 grid grid-cols-2 gap-3"},Yt={class:"rounded-2xl bg-emerald-50 p-4 ring-1 ring-emerald-100"},Pt={class:"mt-1 text-base font-semibold text-emerald-700"},Ut={class:"rounded-2xl bg-red-50 p-4 ring-1 ring-red-100"},Zt={class:"mt-1 text-base font-semibold text-red-600"},qt={class:"mt-8 pb-[calc(2rem+env(safe-area-inset-bottom))]"},Ht={key:0,class:"mt-4 rounded-3xl border border-dashed border-slate-200 bg-slate-50 px-5 py-10 text-center"},Jt={key:1,class:"mt-4 space-y-4"},Wt={class:"px-5 py-4 text-xs font-bold uppercase tracking-wide text-slate-400"},Kt={class:"divide-y divide-slate-100"},Gt={class:"min-w-0"},Qt={class:"truncate text-sm font-semibold text-slate-900"},Xt={class:"mt-1 text-xs font-semibold text-slate-400"},el={key:0,class:"mt-1 text-[11px] font-semibold text-slate-400"},tl={class:"space-y-8"},ll={class:"flex items-center justify-between"},sl={class:"flex items-center gap-3"},al={class:"grid gap-6 xl:grid-cols-[420px_1fr]"},nl={class:"rounded-2xl bg-white p-7 shadow-sm ring-1 ring-slate-200/60"},ol={key:0,class:"mt-3 h-9 w-48 animate-pulse rounded-lg bg-slate-200"},il={key:1,class:"mt-3 text-3xl font-bold tracking-tight text-slate-900"},rl={class:"mt-6 rounded-2xl bg-slate-50 p-4 text-sm font-semibold text-slate-600"},ul={class:"rounded-2xl bg-white p-7 shadow-sm ring-1 ring-slate-200/60"},dl={class:"flex items-center justify-between"},cl={key:0,class:"mt-6 space-y-3"},vl={class:"min-w-0"},ml={class:"truncate text-sm font-semibold text-slate-900"},pl={class:"mt-1 text-xs font-semibold text-slate-400"},bl={key:1,class:"mt-6 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-6 py-10 text-center"},Se="Isso ir√° excluir tamb√©m todas as transa√ß√µes vinculadas a esta conta. Esta a√ß√£o n√£o pode ser desfeita.",_l=de({__name:"Show",props:{accountKey:{}},setup(j){const z=j,x=Ve(),N=je(),C=v(()=>N.props.bootstrap??{entries:[],goals:[],accounts:[],categories:[],tags:[]}),n=v(()=>C.value.accounts.find(l=>l.id===z.accountKey)),h=v(()=>n.value?.name??"Conta"),b=c(new Map),M=c(new Map),k=c(new Map),S=async l=>{if(l){b.value.delete(l),M.value.delete(l),k.value.set(l,!0);try{const[t,i]=l.split("-").map(Number),d=await ee(`/api/contas-by-month?year=${t}&month=${i}`,{method:"GET"}),B=d?.accounts??d?.contas??[],K=Array.isArray(B)?B.find(Ae=>String(Ae.id)===String(z.accountKey)):null,se=Number(K?.current_balance??K?.saldo_atual??K?.saldo??0);b.value.set(l,Number.isFinite(se)?se:0),d?.mode&&M.value.set(l,String(d.mode))}catch(t){console.error("Failed to load balance for month",t),b.value.set(l,0)}finally{k.value.set(l,!1)}}},A=v(()=>C.value.entries??[]),f=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),_=v(()=>{const l=new Date,t=[];for(let i=-120;i<=120;i+=1){const d=new Date(l.getFullYear(),l.getMonth()+i,1),B=new Intl.DateTimeFormat("pt-BR",{month:"short"}).format(d).replace(".","").toUpperCase();t.push({key:`${d.getFullYear()}-${d.getMonth()}`,label:B,date:d})}return t}),g=`${new Date().getFullYear()}-${new Date().getMonth()}`,o=c(_.value.find(l=>l.key===g)?.key??_.value[0]?.key??""),p=v(()=>_.value.find(l=>l.key===o.value)??_.value[0]);ce(o,l=>{S(l)},{immediate:!0});const R=v(()=>{const l=o.value;return k.value.get(l)?null:b.value.has(l)?b.value.get(l)??0:null}),H=v(()=>{const l=o.value;return l?k.value.get(l)??!1:!1}),G=v(()=>{const l=h.value;return l?(A.value??[]).filter(t=>t.accountLabel===l):[]}),J=v(()=>{const l=p.value?.date?.getMonth(),t=p.value?.date?.getFullYear();return l==null||t==null?[]:G.value.filter(d=>{if(!d.transactionDate)return!0;const B=new Date(d.transactionDate);return B.getMonth()===l&&B.getFullYear()===t}).sort((d,B)=>{const K=d.transactionDate?new Date(d.transactionDate).getTime():0;return(B.transactionDate?new Date(B.transactionDate).getTime():0)-K})}),Y=v(()=>J.value.filter(l=>l.kind==="income").reduce((l,t)=>l+(Number(t.amount)||0),0)),P=v(()=>J.value.filter(l=>l.kind==="expense").reduce((l,t)=>l+(Number(t.amount)||0),0)),w=v(()=>{const l=new Date,t=p.value?.date;return t?t.getMonth()===l.getMonth()&&t.getFullYear()===l.getFullYear():!0}),s=v(()=>n.value?(R.value??0)-(Y.value-P.value):0);v(()=>s.value+Y.value-P.value);const a=v(()=>n.value?.type!=="wallet"||!w.value?!1:P.value>Y.value),D=v(()=>{const l=new Map;for(const t of J.value){const i=t.dateLabel??"SEM DATA",d=l.get(i)??[];d.push(t),l.set(i,d)}return Array.from(l.entries()).map(([t,i])=>({dateLabel:t,list:i}))}),Q=l=>{const t=l.transactionDate?new Date(l.transactionDate):new Date,i=String(t.getDate()).padStart(2,"0"),d=t.toLocaleString("pt-BR",{month:"short"}).replace(".","").toUpperCase();return`${i} ${d}`},ve=v(()=>G.value.map(l=>({id:l.id,day:Q(l),title:l.title,amount:l.amount,kind:l.kind}))),W=c(!1),le=c(""),U=l=>{le.value=l,W.value=!0},F=c(!1),I=c(!1),Z=c(!1),V=c(!1),me=v(()=>!n.value||n.value.type!=="bank"?null:{id:String(n.value.id),name:n.value.name,icon:n.value.icon??"bank",current_balance:Number(n.value.current_balance??0),color:n.value.color??"#14B8A6",incluir_soma:n.value.incluir_soma??!0,institution:n.value.institution??null,bank_account_type:n.value.bank_account_type??null}),pe=v(()=>`Tem certeza que deseja excluir a conta "${h.value}"?`),be=async l=>{if(l.id)try{await ee(`/api/contas/${l.id}`,{method:"PATCH",body:JSON.stringify({name:l.name,icon:l.icon,type:"bank",current_balance:l.current_balance,color:l.color,incluir_soma:l.incluir_soma,institution:l.institution,bank_account_type:l.bank_account_type})}),U("Conta atualizada"),I.value=!1,ne.reload()}catch{U("N√£o foi poss√≠vel atualizar a conta")}},xe=async()=>{if(n.value)try{await ee(`/api/contas/${n.value.id}`,{method:"DELETE"}),U("Conta exclu√≠da"),ne.visit(route("accounts.index"))}catch{U("N√£o foi poss√≠vel excluir a conta")}finally{V.value=!1}},fe=c(!1),ge=c("income"),we=c(null),De=()=>{ge.value="income",we.value={account:h.value},fe.value=!0},Ee=()=>{ge.value="transfer",we.value={account:h.value},fe.value=!0},he=async l=>{try{const t={name:l.name,type:"wallet",icon:"wallet",initial_balance:l.initial_balance,color:l.color};l.incluir_soma!==void 0&&(t.incluir_soma=l.incluir_soma),await ee(`/api/contas/${l.id}`,{method:"PATCH",body:JSON.stringify(t)}),U("Carteira atualizada"),Z.value=!1,ne.reload()}catch{U("N√£o foi poss√≠vel atualizar a carteira")}};return(l,t)=>(r(),u(E,null,[y(T(Ne),{title:h.value},null,8,["title"]),T(x)?(r(),ke(Te,{key:0,"show-nav":!1},{default:q(()=>[e("header",Bt,[y(T(ae),{href:l.route("dashboard"),class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white text-slate-600 shadow-sm ring-1 ring-slate-200/60","aria-label":"Voltar"},{default:q(()=>[...t[16]||(t[16]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),_:1},8,["href"]),e("div",St,[n.value?.type!=="wallet"?(r(),u("div",Dt,"Conta")):(r(),u("div",Et,"Carteira")),e("div",At,m(h.value),1)]),e("div",jt,[e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white text-slate-600 shadow-sm ring-1 ring-slate-200/60","aria-label":"A√ß√µes",onClick:t[0]||(t[0]=i=>F.value=!F.value)},[...t[17]||(t[17]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 20a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"}),e("path",{d:"M12 13a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"}),e("path",{d:"M12 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"})],-1)])]),F.value?(r(),u("div",{key:0,class:"fixed inset-0 z-[65]",onClick:t[4]||(t[4]=i=>F.value=!1)},[e("div",{class:"absolute right-5 top-16 w-56 overflow-hidden rounded-2xl bg-white shadow-2xl ring-1 ring-slate-200/70",onClick:t[3]||(t[3]=Fe(()=>{},["stop"]))},[e("button",{type:"button",class:"flex w-full items-center gap-3 px-4 py-3 text-left text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:t[1]||(t[1]=i=>n.value?.type==="wallet"?(Z.value=!0,F.value=!1):(I.value=!0,F.value=!1))},[t[18]||(t[18]=e("span",{class:"flex h-9 w-9 items-center justify-center rounded-xl bg-slate-100 text-slate-600"},[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 20h9"}),e("path",{d:"M16.5 3.5a2.1 2.1 0 0 1 3 3L7 19l-4 1 1-4Z"})])],-1)),X(" "+m(n.value?.type==="wallet"?"Editar carteira":"Editar conta"),1)]),e("button",{type:"button",class:"flex w-full items-center gap-3 px-4 py-3 text-left text-sm font-semibold text-red-600 hover:bg-red-50",onClick:t[2]||(t[2]=i=>{V.value=!0,F.value=!1})},[...t[19]||(t[19]=[e("span",{class:"flex h-9 w-9 items-center justify-center rounded-xl bg-red-50 text-red-500"},[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18"}),e("path",{d:"M8 6V4h8v2"}),e("path",{d:"M6 6l1 16h10l1-16"})])],-1),X(" Excluir conta ",-1)])])])])):L("",!0)])]),e("div",Nt,[y(ze,{modelValue:o.value,"onUpdate:modelValue":t[5]||(t[5]=i=>o.value=i),months:_.value},null,8,["modelValue","months"])]),a.value?(r(),u("div",Ft,[e("div",{class:"flex items-start gap-2"},[t[23]||(t[23]=e("div",{class:"text-lg"},"‚ö†Ô∏è",-1)),e("div",{class:"flex-1"},[t[22]||(t[22]=e("h3",{class:"text-sm font-semibold text-amber-900"}," Voc√™ registrou mais gastos do que tinha na carteira ",-1)),e("div",{class:"mt-3 grid grid-cols-2 gap-3"},[e("button",{type:"button",class:"flex items-center justify-center rounded-lg bg-white px-3 py-2 text-center text-sm font-semibold text-amber-700 hover:bg-amber-100",onClick:De},[...t[20]||(t[20]=[e("span",null,"Adicionar dinheiro",-1)])]),e("button",{type:"button",class:"flex items-center justify-center rounded-lg bg-white px-3 py-2 text-center text-sm font-semibold text-amber-700 hover:bg-amber-100",onClick:Ee},[...t[21]||(t[21]=[e("span",null,"Criar transfer√™ncia",-1)])])])])])])):L("",!0),e("section",It,[e("div",Vt,m(w.value?"Saldo atual":"Balan√ßo final"),1),H.value?(r(),u("div",Tt)):(r(),u("div",Lt,m(f(R.value??0)),1)),!w.value&&n.value?.type==="wallet"?(r(),u("div",Ot," (in√≠cio: "+m(p.value?.date?.getDate()===1?"01":String(p.value?.date?.getDate()).padStart(2,"0"))+" - final: "+m(new Date(p.value?.date?.getFullYear()??2024,(p.value?.date?.getMonth()??0)+1,0).getDate())+") ",1)):L("",!0),H.value?(r(),u("div",zt,[...t[24]||(t[24]=[e("div",{class:"rounded-2xl bg-emerald-50 p-4 ring-1 ring-emerald-100"},[e("div",{class:"flex items-center justify-between text-[10px] font-semibold uppercase tracking-wide text-emerald-700"},[e("span",null,"Entrou"),e("span",null,"‚Ä∫")]),e("div",{class:"mt-1 h-6 w-24 animate-pulse rounded bg-emerald-200"})],-1),e("div",{class:"rounded-2xl bg-red-50 p-4 ring-1 ring-red-100"},[e("div",{class:"flex items-center justify-between text-[10px] font-semibold uppercase tracking-wide text-red-600"},[e("span",null,"Saiu"),e("span",null,"‚Ä∫")]),e("div",{class:"mt-1 h-6 w-24 animate-pulse rounded bg-red-200"})],-1)])])):(r(),u("div",Rt,[e("div",Yt,[t[25]||(t[25]=e("div",{class:"flex items-center justify-between text-[10px] font-semibold uppercase tracking-wide text-emerald-700"},[e("span",null,"Entrou"),e("span",null,"‚Ä∫")],-1)),e("div",Pt,m(f(Y.value)),1)]),e("div",Ut,[t[26]||(t[26]=e("div",{class:"flex items-center justify-between text-[10px] font-semibold uppercase tracking-wide text-red-600"},[e("span",null,"Saiu"),e("span",null,"‚Ä∫")],-1)),e("div",Zt,m(f(P.value)),1)])]))]),e("section",qt,[t[28]||(t[28]=e("div",{class:"text-lg font-semibold text-slate-900"},"Movimenta√ß√µes",-1)),D.value.length===0?(r(),u("div",Ht,[...t[27]||(t[27]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Sem lan√ßamentos",-1),e("div",{class:"mt-1 text-xs text-slate-500"},"Quando houver movimenta√ß√µes, elas aparecem aqui.",-1)])])):(r(),u("div",Jt,[(r(!0),u(E,null,O(D.value,i=>(r(),u("div",{key:i.dateLabel,class:"rounded-3xl bg-white shadow-sm ring-1 ring-slate-200/60"},[e("div",Wt,m(i.dateLabel),1),e("div",Kt,[(r(!0),u(E,null,O(i.list,d=>(r(),u("div",{key:d.id,class:"flex items-center justify-between gap-4 px-5 py-4"},[e("div",Gt,[e("div",Qt,m(d.title),1),e("div",Xt,m(d.categoryLabel),1)]),e("div",{class:$(["text-right text-sm font-semibold",d.kind==="income"?"text-emerald-600":"text-red-500"])},[X(m(d.kind==="income"?"+":"-")+" "+m(f(d.amount))+" ",1),d.installment?(r(),u("div",el,m(d.installment),1)):L("",!0)],2)]))),128))])]))),128))]))]),y(_e,{show:W.value,message:le.value,onDismiss:t[6]||(t[6]=i=>W.value=!1)},null,8,["show","message"]),y(Me,{open:I.value,initial:me.value,onClose:t[7]||(t[7]=i=>I.value=!1),onSave:be},null,8,["open","initial"]),y(Be,{open:Z.value,wallet:n.value?{id:n.value.id,name:n.value.name,initial_balance:n.value.initial_balance,current_balance:n.value.current_balance,color:n.value.color??"#14B8A6",incluir_soma:n.value.incluir_soma??!0}:null,onClose:t[8]||(t[8]=i=>Z.value=!1),onSave:he},null,8,["open","wallet"]),y($e,{open:V.value,title:"Excluir conta?",message:pe.value,warningText:Se,danger:"",confirmLabel:"Excluir",onClose:t[9]||(t[9]=i=>V.value=!1),onConfirm:xe},null,8,["open","message"])]),_:1})):(r(),ke(Le,{key:1,title:h.value,subtitle:"Detalhes da conta","show-search":!1,"show-new-action":!1},{default:q(()=>[e("div",tl,[e("div",ll,[y(T(ae),{href:l.route("accounts.index"),class:"inline-flex h-11 w-11 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm hover:bg-slate-50","aria-label":"Voltar"},{default:q(()=>[...t[29]||(t[29]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),_:1},8,["href"]),e("div",sl,[e("button",{type:"button",class:"inline-flex h-11 items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-600 hover:bg-slate-50",onClick:t[10]||(t[10]=i=>I.value=!0)}," Editar "),e("button",{type:"button",class:"inline-flex h-11 items-center gap-2 rounded-xl border border-red-200 bg-white px-4 text-sm font-semibold text-red-600 hover:bg-red-50",onClick:t[11]||(t[11]=i=>V.value=!0)}," Excluir ")])]),e("div",al,[e("div",nl,[t[30]||(t[30]=e("div",{class:"text-xs font-semibold uppercase tracking-wide text-slate-400"},"Saldo atual",-1)),H.value?(r(),u("div",ol)):(r(),u("div",il,m(f(R.value??0).replace("R$","R$")),1)),e("div",rl," Tipo: "+m(n.value?.type??"-"),1)]),e("div",ul,[e("div",dl,[t[32]||(t[32]=e("div",{class:"text-base font-semibold text-slate-900"},"Transa√ß√µes desta conta",-1)),y(T(ae),{href:l.route("accounts.index"),class:"text-sm font-semibold text-[#14B8A6]"},{default:q(()=>[...t[31]||(t[31]=[X("Ver todas",-1)])]),_:1},8,["href"])]),ve.value.length?(r(),u("div",cl,[(r(!0),u(E,null,O(ve.value,i=>(r(),u("div",{key:i.id,class:"flex items-center justify-between rounded-2xl border border-slate-100 bg-white px-5 py-4"},[e("div",vl,[e("div",ml,m(i.title),1),e("div",pl,m(i.day),1)]),e("div",{class:$(["text-sm font-semibold",i.kind==="income"?"text-emerald-600":"text-red-500"])},m(i.kind==="income"?"+":"-")+m(f(i.amount).replace("R$","R$")),3)]))),128))])):(r(),u("div",bl,[...t[33]||(t[33]=[e("div",{class:"text-sm font-semibold text-slate-900"},"Sem lan√ßamentos",-1),e("div",{class:"mt-1 text-xs text-slate-500"},"Adicione movimenta√ß√µes para ver o extrato.",-1)])]))])])]),y(Me,{open:I.value,initial:me.value,onClose:t[12]||(t[12]=i=>I.value=!1),onSave:be},null,8,["open","initial"]),y(Be,{open:Z.value,wallet:n.value?{id:n.value.id,name:n.value.name,initial_balance:n.value.initial_balance,current_balance:n.value.current_balance,color:n.value.color??"#14B8A6",incluir_soma:n.value.incluir_soma??!0}:null,onClose:t[13]||(t[13]=i=>Z.value=!1),onSave:he},null,8,["open","wallet"]),y($e,{open:V.value,title:"Excluir conta?",message:pe.value,warningText:Se,danger:"",confirmLabel:"Excluir",onClose:t[14]||(t[14]=i=>V.value=!1),onConfirm:xe},null,8,["open","message"]),y(_e,{show:W.value,message:le.value,onDismiss:t[15]||(t[15]=i=>W.value=!1)},null,8,["show","message"])]),_:1},8,["title"]))],64))}});export{_l as default};
