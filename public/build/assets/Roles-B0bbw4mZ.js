import{d as S,c as _,h as p,g as o,f as b,a as P,b as C,D as A,w as B,e,o as l,F as c,r as v,t as i,x as N,K as D,n as h,G as M,H as $,C as j,m as F}from"./app-Pd0ejbZJ.js";import{u as R,_ as V}from"./useIsMobile-CRomRP0o.js";import{_ as q}from"./DesktopShell.vue_vue_type_script_setup_true_lang-CaKEcI4E.js";import{_ as z}from"./AdminHeader.vue_vue_type_script_setup_true_lang-BMtTlgrr.js";const J={class:"space-y-4"},O={class:"rounded-3xl bg-white p-6 shadow-sm ring-1 ring-slate-200/60"},E={class:"mt-4 grid gap-3 md:grid-cols-2"},G={class:"text-base font-semibold text-slate-900"},H={class:"mt-1 text-sm text-slate-600"},I={class:"rounded-3xl bg-white p-6 shadow-sm ring-1 ring-slate-200/60"},K={class:"flex flex-wrap items-center justify-between gap-3"},L={class:"flex items-center gap-2"},U=["value"],Q=["disabled"],T={class:"mt-4 overflow-x-auto"},W={class:"min-w-full text-left text-sm"},X={class:"divide-y divide-slate-100"},Y={class:"py-3 pr-4"},Z={class:"font-semibold text-slate-900"},ee={class:"mt-1 text-xs font-semibold text-slate-400"},se={class:"py-3 pr-4 text-slate-600"},te={class:"py-3 pr-4 text-center"},ae={key:0,class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-50 text-emerald-700"},le=["onClick","aria-label"],ce=S({__name:"Roles",props:{roles:{},permissions:{},matrix:{}},setup(x){const f=R(),y=_(()=>f.value?V:q),g=_(()=>f.value?{showNav:!1}:{title:"Administração",showSearch:!1,showNewAction:!1}),u=x,a=p("user"),r=p(!1),m=p(JSON.parse(JSON.stringify(u.matrix))),d=(n,t)=>!!m.value?.[n]?.[t],w=(n,t)=>{n!=="admin"&&(m.value[n][t]=!d(n,t))},k=async()=>{r.value=!0,F.patch(route("admin.roles.update",a.value),{permissions:m.value[a.value]},{preserveScroll:!0,onFinish:()=>{r.value=!1}})};return(n,t)=>(l(),o(c,null,[b(C(A),{title:"Administração · Papéis e Permissões"}),(l(),P(j(y.value),M($(g.value)),{default:B(()=>[e("div",J,[b(z,{description:"Mapa atual de papéis e permissões do sistema."}),e("div",O,[t[1]||(t[1]=e("div",{class:"text-sm font-semibold text-slate-900"},"Papéis",-1)),e("div",E,[(l(!0),o(c,null,v(x.roles,s=>(l(),o("div",{key:s.key,class:"rounded-2xl bg-slate-50 p-4 ring-1 ring-slate-200/60"},[e("div",G,i(s.label),1),e("div",H,i(s.description),1)]))),128))])]),e("div",I,[e("div",K,[t[2]||(t[2]=e("div",{class:"text-sm font-semibold text-slate-900"},"Permissões",-1)),e("div",L,[N(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value=s),class:"h-10 appearance-none rounded-xl border border-slate-200 bg-white px-3 pr-9 text-sm font-semibold text-slate-800","aria-label":"Selecionar papel"},[(l(!0),o(c,null,v(u.roles,s=>(l(),o("option",{key:s.key,value:s.key},i(s.label),9,U))),128))],512),[[D,a.value]]),e("button",{type:"button",class:"inline-flex items-center justify-center rounded-xl bg-[#14B8A6] px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20 disabled:cursor-not-allowed disabled:opacity-60",disabled:r.value||a.value==="admin",onClick:k},i(r.value?"Salvando…":"Salvar"),9,Q)])]),e("div",T,[e("table",W,[t[3]||(t[3]=e("thead",{class:"text-xs font-bold uppercase tracking-wide text-slate-400"},[e("tr",null,[e("th",{class:"py-3 pr-4"},"Permissão"),e("th",{class:"py-3 pr-4"},"Descrição"),e("th",{class:"py-3 pr-4 text-center"},"Permitido")])],-1)),e("tbody",X,[(l(!0),o(c,null,v(u.permissions,s=>(l(),o("tr",{key:s.key},[e("td",Y,[e("div",Z,i(s.label),1),e("div",ee,i(s.key),1)]),e("td",se,i(s.description),1),e("td",te,[a.value==="admin"?(l(),o("div",ae," ✓ ")):(l(),o("button",{key:1,type:"button",class:h(["inline-flex h-7 w-11 items-center rounded-full px-1 ring-1 transition",d(a.value,s.key)?"bg-[#14B8A6] ring-emerald-300/70":"bg-slate-100 ring-slate-200/70"]),onClick:oe=>w(a.value,s.key),"aria-label":d(a.value,s.key)?"Desativar permissão":"Ativar permissão"},[e("span",{class:h(["h-5 w-5 rounded-full bg-white shadow-sm transition-transform",d(a.value,s.key)?"translate-x-4":"translate-x-0"])},null,2)],10,le))])]))),128))])])]),t[4]||(t[4]=e("div",{class:"mt-4 text-xs font-semibold text-slate-400"}," Nota: o acesso real ao admin continua restrito ao e-mail `contato@kitamo.com.br` (isso não muda mesmo que você desmarque `admin.access`). ",-1))])])]),_:1},16))],64))}});export{ce as default};
